/*! For license information please see main.5151b0340cdacb98a4a1.js.LICENSE.txt */
(()=>{"use strict";var t,e,r,n,o={914:(t,e,r)=>{r.r(e),r.d(e,{Headers:()=>a,Request:()=>u,Response:()=>c,default:()=>i,fetch:()=>o});var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r.g)return r.g;throw new Error("unable to locate global object")}(),o=n.fetch;const i=n.fetch.bind(n);var a=n.Headers,u=n.Request,c=n.Response},26:function(t,e,r){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){o=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",s=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),u=new C(n||[]);return a(i,"_invoke",{value:L(t,r,u)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",v="suspendedYield",y="executing",b="completed",m={};function g(){}function w(){}function k(){}var _={};f(_,c,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(I([])));E&&E!==r&&i.call(E,c)&&(_=E);var S=k.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,a,u,c){var s=p(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==n(f)&&i.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,c)}),(function(t){r("throw",t,u,c)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,c)}))}c(s.arg)}var o;a(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}})}function L(e,r,n){var o=d;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===b){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=P(u,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=b,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?b:v,s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=b,n.method="throw",n.arg=s.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=k,a(S,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:w,configurable:!0}),w.displayName=f(k,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,k):(t.__proto__=k,f(t,l,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},j(O.prototype),f(O.prototype,s,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(S),f(S,l,"Generator"),f(S,c,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),s=i.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function i(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}var c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=c(r(914)),l=c(r(511)),f=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=s.default:this.fetch=fetch},e=[{key:"throwOnError",value:function(){return this.shouldThrowOnError=!0,this}},{key:"setHeader",value:function(t,e){return this.headers=Object.assign({},this.headers),this.headers[t]=e,this}},{key:"then",value:function(t,e){var r=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");var n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(function(){var t,e=(t=o().mark((function t(e){var n,i,a,u,c,s,f,h,p,d,v,y,b;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=null,c=null,s=null,f=e.status,h=e.statusText,!e.ok){t.next=17;break}if("HEAD"===r.method){t.next=11;break}return t.next=9,e.text();case 9:""===(p=t.sent)||(c="text/csv"===r.headers.Accept||r.headers.Accept&&r.headers.Accept.includes("application/vnd.pgrst.plan+text")?p:JSON.parse(p));case 11:d=null===(n=r.headers.Prefer)||void 0===n?void 0:n.match(/count=(exact|planned|estimated)/),v=null===(i=e.headers.get("content-range"))||void 0===i?void 0:i.split("/"),d&&v&&v.length>1&&(s=parseInt(v[1])),r.isMaybeSingle&&"GET"===r.method&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:"Results contain ".concat(c.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,s=null,f=406,h="Not Acceptable"):c=1===c.length?c[0]:null),t.next=24;break;case 17:return t.next=19,e.text();case 19:y=t.sent;try{u=JSON.parse(y),Array.isArray(u)&&404===e.status&&(c=[],u=null,f=200,h="OK")}catch(t){404===e.status&&""===y?(f=204,h="No Content"):u={message:y}}if(u&&r.isMaybeSingle&&(null===(a=null==u?void 0:u.details)||void 0===a?void 0:a.includes("0 rows"))&&(u=null,f=200,h="OK"),!u||!r.shouldThrowOnError){t.next=24;break}throw new l.default(u);case 24:return b={error:u,data:c,count:s,status:f,statusText:h},t.abrupt("return",b);case 26:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function u(t){i(a,n,o,u,c,"next",t)}function c(t){i(a,n,o,u,c,"throw",t)}u(void 0)}))});return function(t){return e.apply(this,arguments)}}());return this.shouldThrowOnError||(n=n.catch((function(t){var e,r,n;return{error:{message:"".concat(null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"FetchError",": ").concat(null==t?void 0:t.message),details:"".concat(null!==(r=null==t?void 0:t.stack)&&void 0!==r?r:""),hint:"",code:"".concat(null!==(n=null==t?void 0:t.code)&&void 0!==n?n:"")},data:null,count:null,status:0,statusText:""}}))),n.then(t,e)}}],e&&a(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();e.default=f},646:function(t,e,r){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}var c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=c(r(198)),l=c(r(532)),f=r(805),h=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.headers,o=void 0===n?{}:n,i=r.schema,a=r.fetch;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=e,this.headers=Object.assign(Object.assign({},f.DEFAULT_HEADERS),o),this.schemaName=i,this.fetch=a}return e=t,r=[{key:"from",value:function(t){var e=new URL("".concat(this.url,"/").concat(t));return new s.default(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}},{key:"schema",value:function(e){return new t(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}},{key:"rpc",value:function(t){var e,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.head,u=void 0!==a&&a,c=i.get,s=void 0!==c&&c,f=i.count,h=new URL("".concat(this.url,"/rpc/").concat(t));u||s?(e=u?"HEAD":"GET",Object.entries(n).filter((function(t){var e=o(t,2);return e[0],void 0!==e[1]})).map((function(t){var e=o(t,2),r=e[0],n=e[1];return[r,Array.isArray(n)?"{".concat(n.join(","),"}"):"".concat(n)]})).forEach((function(t){var e=o(t,2),r=e[0],n=e[1];h.searchParams.append(r,n)}))):(e="POST",r=n);var p=Object.assign({},this.headers);return f&&(p.Prefer="count=".concat(f)),new l.default({method:e,url:h,headers:p,schema:this.schemaName,body:r,fetch:this.fetch,allowEmpty:!1})}}],r&&a(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r}();e.default=h},511:(t,e)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t){var e="function"==typeof Map?new Map:void 0;return n=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(o())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var a=new(t.bind.apply(t,n));return r&&i(a,r.prototype),a}(t,arguments,a(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),i(r,t)},n(t)}function o(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(o=function(){return!!t})()}function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=a(e),function(t,e){if(e&&("object"==r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,o()?Reflect.construct(e,n||[],a(t).constructor):e.apply(t,n))}(this,e,[t.message])).name="PostgrestError",n.details=t.details,n.hint=t.hint,n.code=t.code,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(n(Error));e.default=u},532:function(t,e,r){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}var l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var f=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=c(e),function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,u()?Reflect.construct(e,r||[],c(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(e,t),r=e,a=[{key:"eq",value:function(t,e){return this.url.searchParams.append(t,"eq.".concat(e)),this}},{key:"neq",value:function(t,e){return this.url.searchParams.append(t,"neq.".concat(e)),this}},{key:"gt",value:function(t,e){return this.url.searchParams.append(t,"gt.".concat(e)),this}},{key:"gte",value:function(t,e){return this.url.searchParams.append(t,"gte.".concat(e)),this}},{key:"lt",value:function(t,e){return this.url.searchParams.append(t,"lt.".concat(e)),this}},{key:"lte",value:function(t,e){return this.url.searchParams.append(t,"lte.".concat(e)),this}},{key:"like",value:function(t,e){return this.url.searchParams.append(t,"like.".concat(e)),this}},{key:"likeAllOf",value:function(t,e){return this.url.searchParams.append(t,"like(all).{".concat(e.join(","),"}")),this}},{key:"likeAnyOf",value:function(t,e){return this.url.searchParams.append(t,"like(any).{".concat(e.join(","),"}")),this}},{key:"ilike",value:function(t,e){return this.url.searchParams.append(t,"ilike.".concat(e)),this}},{key:"ilikeAllOf",value:function(t,e){return this.url.searchParams.append(t,"ilike(all).{".concat(e.join(","),"}")),this}},{key:"ilikeAnyOf",value:function(t,e){return this.url.searchParams.append(t,"ilike(any).{".concat(e.join(","),"}")),this}},{key:"is",value:function(t,e){return this.url.searchParams.append(t,"is.".concat(e)),this}},{key:"in",value:function(t,e){var r=Array.from(new Set(e)).map((function(t){return"string"==typeof t&&new RegExp("[,()]").test(t)?'"'.concat(t,'"'):"".concat(t)})).join(",");return this.url.searchParams.append(t,"in.(".concat(r,")")),this}},{key:"contains",value:function(t,e){return"string"==typeof e?this.url.searchParams.append(t,"cs.".concat(e)):Array.isArray(e)?this.url.searchParams.append(t,"cs.{".concat(e.join(","),"}")):this.url.searchParams.append(t,"cs.".concat(JSON.stringify(e))),this}},{key:"containedBy",value:function(t,e){return"string"==typeof e?this.url.searchParams.append(t,"cd.".concat(e)):Array.isArray(e)?this.url.searchParams.append(t,"cd.{".concat(e.join(","),"}")):this.url.searchParams.append(t,"cd.".concat(JSON.stringify(e))),this}},{key:"rangeGt",value:function(t,e){return this.url.searchParams.append(t,"sr.".concat(e)),this}},{key:"rangeGte",value:function(t,e){return this.url.searchParams.append(t,"nxl.".concat(e)),this}},{key:"rangeLt",value:function(t,e){return this.url.searchParams.append(t,"sl.".concat(e)),this}},{key:"rangeLte",value:function(t,e){return this.url.searchParams.append(t,"nxr.".concat(e)),this}},{key:"rangeAdjacent",value:function(t,e){return this.url.searchParams.append(t,"adj.".concat(e)),this}},{key:"overlaps",value:function(t,e){return"string"==typeof e?this.url.searchParams.append(t,"ov.".concat(e)):this.url.searchParams.append(t,"ov.{".concat(e.join(","),"}")),this}},{key:"textSearch",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.config,o=r.type,i="";"plain"===o?i="pl":"phrase"===o?i="ph":"websearch"===o&&(i="w");var a=void 0===n?"":"(".concat(n,")");return this.url.searchParams.append(t,"".concat(i,"fts").concat(a,".").concat(e)),this}},{key:"match",value:function(t){var e=this;return Object.entries(t).forEach((function(t){var r=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),n=r[0],i=r[1];e.url.searchParams.append(n,"eq.".concat(i))})),this}},{key:"not",value:function(t,e,r){return this.url.searchParams.append(t,"not.".concat(e,".").concat(r)),this}},{key:"or",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.foreignTable,n=e.referencedTable,o=void 0===n?r:n,i=o?"".concat(o,".or"):"or";return this.url.searchParams.append(i,"(".concat(t,")")),this}},{key:"filter",value:function(t,e,r){return this.url.searchParams.append(t,"".concat(e,".").concat(r)),this}}],a&&i(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a}(l(r(42)).default);e.default=f},198:function(t,e,r){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}var c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=c(r(532)),l=function(){return t=function t(e,r){var n=r.headers,o=void 0===n?{}:n,i=r.schema,a=r.fetch;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=e,this.headers=o,this.schema=i,this.fetch=a},e=[{key:"select",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.head,n=void 0!==r&&r,o=e.count,i=n?"HEAD":"GET",a=!1,u=(null!=t?t:"*").split("").map((function(t){return/\s/.test(t)&&!a?"":('"'===t&&(a=!a),t)})).join("");return this.url.searchParams.set("select",u),o&&(this.headers.Prefer="count=".concat(o)),new s.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}},{key:"insert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.count,n=e.defaultToNull,i=void 0===n||n,a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push("count=".concat(r)),i||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){var u=t.reduce((function(t,e){return t.concat(Object.keys(e))}),[]);if(u.length>0){var c=o(new Set(u)).map((function(t){return'"'.concat(t,'"')}));this.url.searchParams.set("columns",c.join(","))}}return new s.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}},{key:"upsert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.onConflict,n=e.ignoreDuplicates,i=void 0!==n&&n,a=e.count,u=e.defaultToNull,c=void 0===u||u,l=["resolution=".concat(i?"ignore":"merge","-duplicates")];if(void 0!==r&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push("count=".concat(a)),c||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){var f=t.reduce((function(t,e){return t.concat(Object.keys(e))}),[]);if(f.length>0){var h=o(new Set(f)).map((function(t){return'"'.concat(t,'"')}));this.url.searchParams.set("columns",h.join(","))}}return new s.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}},{key:"update",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).count,r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),e&&r.push("count=".concat(e)),this.headers.Prefer=r.join(","),new s.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}},{key:"delete",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).count,e=[];return t&&e.push("count=".concat(t)),this.headers.Prefer&&e.unshift(this.headers.Prefer),this.headers.Prefer=e.join(","),new s.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}],e&&a(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();e.default=l},42:function(t,e,r){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}function a(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(a=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=u(e),function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,a()?Reflect.construct(e,r||[],u(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(e,t),r=e,i=[{key:"select",value:function(t){var e=!1,r=(null!=t?t:"*").split("").map((function(t){return/\s/.test(t)&&!e?"":('"'===t&&(e=!e),t)})).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}},{key:"order",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.ascending,n=void 0===r||r,o=e.nullsFirst,i=e.foreignTable,a=e.referencedTable,u=void 0===a?i:a,c=u?"".concat(u,".order"):"order",s=this.url.searchParams.get(c);return this.url.searchParams.set(c,"".concat(s?"".concat(s,","):"").concat(t,".").concat(n?"asc":"desc").concat(void 0===o?"":o?".nullsfirst":".nullslast")),this}},{key:"limit",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.foreignTable,n=e.referencedTable,o=void 0===n?r:n,i=void 0===o?"limit":"".concat(o,".limit");return this.url.searchParams.set(i,"".concat(t)),this}},{key:"range",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.foreignTable,o=r.referencedTable,i=void 0===o?n:o,a=void 0===i?"offset":"".concat(i,".offset"),u=void 0===i?"limit":"".concat(i,".limit");return this.url.searchParams.set(a,"".concat(t)),this.url.searchParams.set(u,"".concat(e-t+1)),this}},{key:"abortSignal",value:function(t){return this.signal=t,this}},{key:"single",value:function(){return this.headers.Accept="application/vnd.pgrst.object+json",this}},{key:"maybeSingle",value:function(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}},{key:"csv",value:function(){return this.headers.Accept="text/csv",this}},{key:"geojson",value:function(){return this.headers.Accept="application/geo+json",this}},{key:"explain",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.analyze,n=void 0!==r&&r,o=e.verbose,i=void 0!==o&&o,a=e.settings,u=void 0!==a&&a,c=e.buffers,s=void 0!==c&&c,l=e.wal,f=void 0!==l&&l,h=e.format,p=void 0===h?"text":h,d=[n?"analyze":null,i?"verbose":null,u?"settings":null,s?"buffers":null,f?"wal":null].filter(Boolean).join("|"),v=null!==(t=this.headers.Accept)&&void 0!==t?t:"application/json";return this.headers.Accept="application/vnd.pgrst.plan+".concat(p,'; for="').concat(v,'"; options=').concat(d,";"),this}},{key:"rollback",value:function(){var t;return(null!==(t=this.headers.Prefer)&&void 0!==t?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}},{key:"returns",value:function(){return this}}],i&&o(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(s(r(26)).default);e.default=l},805:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_HEADERS=void 0;var n=r(516);e.DEFAULT_HEADERS={"X-Client-Info":"postgrest-js/".concat(n.version)}},752:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PostgrestError=e.PostgrestBuilder=e.PostgrestTransformBuilder=e.PostgrestFilterBuilder=e.PostgrestQueryBuilder=e.PostgrestClient=void 0;var o=n(r(646));e.PostgrestClient=o.default;var i=n(r(198));e.PostgrestQueryBuilder=i.default;var a=n(r(532));e.PostgrestFilterBuilder=a.default;var u=n(r(42));e.PostgrestTransformBuilder=u.default;var c=n(r(26));e.PostgrestBuilder=c.default;var s=n(r(511));e.PostgrestError=s.default,e.default={PostgrestClient:o.default,PostgrestQueryBuilder:i.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:c.default,PostgrestError:s.default}},516:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.version=void 0,e.version="0.0.0-automated"}},i={};function a(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={exports:{}};return o[t].call(r.exports,r,r.exports,a),r.exports}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function s(t,e,r){return e&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e,r){return e=b(e),function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,v()?Reflect.construct(e,r||[],b(t).constructor):e.apply(t,r))}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}function d(t){var e="function"==typeof Map?new Map:void 0;return d=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(v())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&y(o,r.prototype),o}(t,arguments,b(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),y(r,t)},d(t)}function v(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(v=function(){return!!t})()}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}a.m=o,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,a.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"==typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"==typeof r.then)return r}var o=Object.create(null);a.r(o);var i={};t=t||[null,e({}),e([]),e(e)];for(var u=2&n&&r;"object"==typeof u&&!~t.indexOf(u);u=e(u))Object.getOwnPropertyNames(u).forEach((t=>i[t]=()=>r[t]));return i.default=()=>r,a.d(o,i),o},a.d=(t,e)=>{for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},a.f={},a.e=t=>Promise.all(Object.keys(a.f).reduce(((e,r)=>(a.f[r](t,e),e)),[])),a.u=t=>t+".02c053cb38814cc19881.js",a.miniCssF=t=>{},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r={},n="lensify:",a.l=(t,e,o,i)=>{if(r[t])r[t].push(e);else{var u,c;if(void 0!==o)for(var s=document.getElementsByTagName("script"),l=0;l<s.length;l++){var f=s[l];if(f.getAttribute("src")==t||f.getAttribute("data-webpack")==n+o){u=f;break}}u||(c=!0,(u=document.createElement("script")).charset="utf-8",u.timeout=120,a.nc&&u.setAttribute("nonce",a.nc),u.setAttribute("data-webpack",n+o),u.src=t),r[t]=[e];var h=(e,n)=>{u.onerror=u.onload=null,clearTimeout(p);var o=r[t];if(delete r[t],u.parentNode&&u.parentNode.removeChild(u),o&&o.forEach((t=>t(n))),e)return e(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:u}),12e4);u.onerror=h.bind(null,u.onerror),u.onload=h.bind(null,u.onload),c&&document.head.appendChild(u)}},a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;a.g.importScripts&&(t=a.g.location+"");var e=a.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=r[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=t})(),(()=>{var t={792:0};a.f.j=(e,r)=>{var n=a.o(t,e)?t[e]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,o)=>n=t[e]=[r,o]));r.push(n[2]=o);var i=a.p+a.u(e),u=new Error;a.l(i,(r=>{if(a.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;u.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",u.name="ChunkLoadError",u.type=o,u.request=i,n[1](u)}}),"chunk-"+e,e)}};var e=(e,r)=>{var n,o,[i,u,c]=r,s=0;if(i.some((e=>0!==t[e]))){for(n in u)a.o(u,n)&&(a.m[n]=u[n]);c&&c(a)}for(e&&e(r);s<i.length;s++)o=i[s],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0},r=self.webpackChunklensify=self.webpackChunklensify||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var m,g=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",o=arguments.length>2?arguments[2]:void 0;return f(this,e),(r=h(this,e,[t])).name=n,r.context=o,r}return p(e,t),s(e)}(d(Error)),w=function(t){function e(t){return f(this,e),h(this,e,["Failed to send a request to the Edge Function","FunctionsFetchError",t])}return p(e,t),s(e)}(g),k=function(t){function e(t){return f(this,e),h(this,e,["Relay Error invoking the Edge Function","FunctionsRelayError",t])}return p(e,t),s(e)}(g),_=function(t){function e(t){return f(this,e),h(this,e,["Edge Function returned a non-2xx status code","FunctionsHttpError",t])}return p(e,t),s(e)}(g);function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function E(){E=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:L(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(I([])));_&&_!==r&&n.call(_,a)&&(w=_);var S=g.prototype=b.prototype=Object.create(w);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==x(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function L(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=P(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(x(e)+" is not iterable")}return m.prototype=g,o(S,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},j(O.prototype),s(O.prototype,u,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(S),s(S,c,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function S(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,j(n.key),n)}}function j(t){var e=function(t){if("object"!=x(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==x(e)?e:e+""}!function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"}(m||(m={}));var O=function(){return t=function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.headers,o=void 0===n?{}:n,i=r.customFetch,u=r.region,c=void 0===u?m.Any:u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=e,this.headers=o,this.region=c,this.fetch=function(t){var e;return e=t||("undefined"==typeof fetch?function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Promise.resolve().then(a.bind(a,914)).then((function(t){return t.default.apply(void 0,e)}))}:fetch),function(){return e.apply(void 0,arguments)}}(i)},e=[{key:"setAuth",value:function(t){this.headers.Authorization="Bearer ".concat(t)}},{key:"invoke",value:function(t){var e,r,n,o,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=this,n=void 0,o=void 0,i=E().mark((function r(){var n,o,i,u,c,s,l,f,h,p;return E().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n=a.headers,o=a.method,i=a.body,u={},(c=a.region)||(c=this.region),c&&"any"!==c&&(u["x-region"]=c),i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",s=i):"string"==typeof i?(u["Content-Type"]="text/plain",s=i):"undefined"!=typeof FormData&&i instanceof FormData?s=i:(u["Content-Type"]="application/json",s=JSON.stringify(i))),r.next=9,this.fetch("".concat(this.url,"/").concat(t),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),n),body:s}).catch((function(t){throw new w(t)}));case 9:if(l=r.sent,!(f=l.headers.get("x-relay-error"))||"true"!==f){r.next=13;break}throw new k(l);case 13:if(l.ok){r.next=15;break}throw new _(l);case 15:if("application/json"!==(h=(null!==(e=l.headers.get("Content-Type"))&&void 0!==e?e:"text/plain").split(";")[0].trim())){r.next=22;break}return r.next=19,l.json();case 19:p=r.sent,r.next=41;break;case 22:if("application/octet-stream"!==h){r.next=28;break}return r.next=25,l.blob();case 25:p=r.sent,r.next=41;break;case 28:if("text/event-stream"!==h){r.next=32;break}p=l,r.next=41;break;case 32:if("multipart/form-data"!==h){r.next=38;break}return r.next=35,l.formData();case 35:p=r.sent,r.next=41;break;case 38:return r.next=40,l.text();case 40:p=r.sent;case 41:return r.abrupt("return",{data:p,error:null});case 44:return r.prev=44,r.t0=r.catch(0),r.abrupt("return",{data:null,error:r.t0});case 47:case"end":return r.stop()}}),r,this,[[0,44]])})),new(o||(o=Promise))((function(t,e){function a(t){try{c(i.next(t))}catch(t){e(t)}}function u(t){try{c(i.throw(t))}catch(t){e(t)}}function c(e){var r;e.done?t(e.value):(r=e.value,r instanceof o?r:new o((function(t){t(r)}))).then(a,u)}c((i=i.apply(r,n||[])).next())}))}}],e&&S(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),L=a(752);const{PostgrestClient:P,PostgrestQueryBuilder:T,PostgrestFilterBuilder:A,PostgrestTransformBuilder:C,PostgrestBuilder:I,PostgrestError:R}=L;var N,G,F,U,D,B,M={"X-Client-Info":"realtime-js/".concat("2.11.2")};function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function J(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,z(n.key),n)}}function z(t){var e=function(t){if("object"!=q(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==q(e)?e:e+""}!function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"}(N||(N={})),(B=G||(G={})).closed="closed",B.errored="errored",B.joined="joined",B.joining="joining",B.leaving="leaving",function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"}(F||(F={})),function(t){t.websocket="websocket"}(U||(U={})),function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"}(D||(D={}));var K=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.HEADER_LENGTH=1},(e=[{key:"decode",value:function(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e("string"==typeof t?JSON.parse(t):{})}},{key:"_binaryDecode",value:function(t){var e=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,e,r)}},{key:"_decodeBroadcast",value:function(t,e,r){var n=e.getUint8(1),o=e.getUint8(2),i=this.HEADER_LENGTH+2,a=r.decode(t.slice(i,i+n));i+=n;var u=r.decode(t.slice(i,i+o));return i+=o,{ref:null,topic:a,event:u,payload:JSON.parse(r.decode(t.slice(i,t.byteLength)))}}}])&&J(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function H(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Y(n.key),n)}}function Y(t){var e=function(t){if("object"!=V(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=V(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==V(e)?e:e+""}var W,$=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r},(e=[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var t=this;clearTimeout(this.timer),this.timer=setTimeout((function(){t.tries=t.tries+1,t.callback()}),this.timerCalc(this.tries+1))}}])&&H(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();!function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"}(W||(W={}));var X=function(t,e){var r,n=null!==(r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==r?r:[];return Object.keys(e).reduce((function(r,o){return r[o]=Q(o,t,e,n),r}),{})},Q=function(t,e,r,n){var o=e.find((function(e){return e.name===t})),i=null==o?void 0:o.type,a=r[t];return i&&!n.includes(i)?Z(i,a):tt(a)},Z=function(t,e){if("_"===t.charAt(0)){var r=t.slice(1,t.length);return ot(e,r)}switch(t){case W.bool:return et(e);case W.float4:case W.float8:case W.int2:case W.int4:case W.int8:case W.numeric:case W.oid:return rt(e);case W.json:case W.jsonb:return nt(e);case W.timestamp:return it(e);case W.abstime:case W.date:case W.daterange:case W.int4range:case W.int8range:case W.money:case W.reltime:case W.text:case W.time:case W.timestamptz:case W.timetz:case W.tsrange:case W.tstzrange:default:return tt(e)}},tt=function(t){return t},et=function(t){switch(t){case"t":return!0;case"f":return!1;default:return t}},rt=function(t){if("string"==typeof t){var e=parseFloat(t);if(!Number.isNaN(e))return e}return t},nt=function(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return console.log("JSON parse error: ".concat(e)),t}return t},ot=function(t,e){if("string"!=typeof t)return t;var r=t.length-1,n=t[r];if("{"===t[0]&&"}"===n){var o,i=t.slice(1,r);try{o=JSON.parse("["+i+"]")}catch(t){o=i?i.split(","):[]}return o.map((function(t){return Z(e,t)}))}return t},it=function(t){return"string"==typeof t?t.replace(" ","T"):t},at=function(t){return t.replace(/^ws/i,"http").replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"").replace(/\/+$/,"")};function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,st(n.key),n)}}function st(t){var e=function(t){if("object"!=ut(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ut(e)?e:e+""}var lt,ft=function(){return t=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.channel=e,this.event=r,this.payload=n,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null},(e=[{key:"resend",value:function(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}},{key:"send",value:function(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}},{key:"updatePayload",value:function(t){this.payload=Object.assign(Object.assign({},this.payload),t)}},{key:"receive",value:function(t,e){var r;return this._hasReceived(t)&&e(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:t,callback:e}),this}},{key:"startTimeout",value:function(){var t=this;this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},(function(e){t._cancelRefEvent(),t._cancelTimeout(),t.receivedResp=e,t._matchReceive(e)})),this.timeoutTimer=setTimeout((function(){t.trigger("timeout",{})}),this.timeout))}},{key:"trigger",value:function(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}},{key:"destroy",value:function(){this._cancelRefEvent(),this._cancelTimeout()}},{key:"_cancelRefEvent",value:function(){this.refEvent&&this.channel._off(this.refEvent,{})}},{key:"_cancelTimeout",value:function(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}},{key:"_matchReceive",value:function(t){var e=t.status,r=t.response;this.recHooks.filter((function(t){return t.status===e})).forEach((function(t){return t.callback(r)}))}},{key:"_hasReceived",value:function(t){return this.receivedResp&&this.receivedResp.status===t}}])&&ct(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vt(n.key),n)}}function vt(t){var e=function(t){if("object"!=ht(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ht(e)?e:e+""}!function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"}(lt||(lt={}));var yt,bt,mt,gt=function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:function(){},onLeave:function(){},onSync:function(){}};var o=(null==r?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},(function(e){var r=n.caller,o=r.onJoin,i=r.onLeave,a=r.onSync;n.joinRef=n.channel._joinRef(),n.state=t.syncState(n.state,e,o,i),n.pendingDiffs.forEach((function(e){n.state=t.syncDiff(n.state,e,o,i)})),n.pendingDiffs=[],a()})),this.channel._on(o.diff,{},(function(e){var r=n.caller,o=r.onJoin,i=r.onLeave,a=r.onSync;n.inPendingSyncState()?n.pendingDiffs.push(e):(n.state=t.syncDiff(n.state,e,o,i),a())})),this.onJoin((function(t,e,r){n.channel._trigger("presence",{event:"join",key:t,currentPresences:e,newPresences:r})})),this.onLeave((function(t,e,r){n.channel._trigger("presence",{event:"leave",key:t,currentPresences:e,leftPresences:r})})),this.onSync((function(){n.channel._trigger("presence",{event:"sync"})}))},r=[{key:"syncState",value:function(t,e,r,n){var o=this.cloneDeep(t),i=this.transformState(e),a={},u={};return this.map(o,(function(t,e){i[t]||(u[t]=e)})),this.map(i,(function(t,e){var r=o[t];if(r){var n=e.map((function(t){return t.presence_ref})),i=r.map((function(t){return t.presence_ref})),c=e.filter((function(t){return i.indexOf(t.presence_ref)<0})),s=r.filter((function(t){return n.indexOf(t.presence_ref)<0}));c.length>0&&(a[t]=c),s.length>0&&(u[t]=s)}else a[t]=e})),this.syncDiff(o,{joins:a,leaves:u},r,n)}},{key:"syncDiff",value:function(t,e,r,n){var o=this,i={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)},a=i.joins,u=i.leaves;return r||(r=function(){}),n||(n=function(){}),this.map(a,(function(e,n){var i,a=null!==(i=t[e])&&void 0!==i?i:[];if(t[e]=o.cloneDeep(n),a.length>0){var u,c=t[e].map((function(t){return t.presence_ref})),s=a.filter((function(t){return c.indexOf(t.presence_ref)<0}));(u=t[e]).unshift.apply(u,function(t){return function(t){if(Array.isArray(t))return pt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return pt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(s))}r(e,a,n)})),this.map(u,(function(e,r){var o=t[e];if(o){var i=r.map((function(t){return t.presence_ref}));o=o.filter((function(t){return i.indexOf(t.presence_ref)<0})),t[e]=o,n(e,o,r),0===o.length&&delete t[e]}})),t}},{key:"map",value:function(t,e){return Object.getOwnPropertyNames(t).map((function(r){return e(r,t[r])}))}},{key:"transformState",value:function(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((function(e,r){var n=t[r];return e[r]="metas"in n?n.metas.map((function(t){return t.presence_ref=t.phx_ref,delete t.phx_ref,delete t.phx_ref_prev,t})):n,e}),{})}},{key:"cloneDeep",value:function(t){return JSON.parse(JSON.stringify(t))}}],(e=[{key:"onJoin",value:function(t){this.caller.onJoin=t}},{key:"onLeave",value:function(t){this.caller.onLeave=t}},{key:"onSync",value:function(t){this.caller.onSync=t}},{key:"inPendingSyncState",value:function(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}])&&dt(t.prototype,e),r&&dt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function kt(){kt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==wt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(wt(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _t(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function xt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){_t(i,n,o,a,u,"next",t)}function u(t){_t(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,St(n.key),n)}}function St(t){var e=function(t){if("object"!=wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wt(e)?e:e+""}!function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"}(yt||(yt={})),function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"}(bt||(bt={})),function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"}(mt||(mt={}));var jt=function(){function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},o=arguments.length>2?arguments[2]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.topic=e,this.params=n,this.socket=o,this.bindings={},this.state=G.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new ft(this,F.join,this.params,this.timeout),this.rejoinTimer=new $((function(){return r._rejoinUntilConnected()}),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(function(){r.state=G.joined,r.rejoinTimer.reset(),r.pushBuffer.forEach((function(t){return t.send()})),r.pushBuffer=[]})),this._onClose((function(){r.rejoinTimer.reset(),r.socket.log("channel","close ".concat(r.topic," ").concat(r._joinRef())),r.state=G.closed,r.socket._remove(r)})),this._onError((function(t){r._isLeaving()||r._isClosed()||(r.socket.log("channel","error ".concat(r.topic),t),r.state=G.errored,r.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(function(){r._isJoining()&&(r.socket.log("channel","timeout ".concat(r.topic),r.joinPush.timeout),r.state=G.errored,r.rejoinTimer.scheduleTimeout())})),this._on(F.reply,{},(function(t,e){r._trigger(r._replyEventName(e),t)})),this.presence=new gt(this),this.broadcastEndpointURL=at(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}return e=t,r=[{key:"subscribe",value:function(t){var e,r,n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";var i=this.params.config,a=i.broadcast,u=i.presence,c=i.private;this._onError((function(e){return null==t?void 0:t(mt.CHANNEL_ERROR,e)})),this._onClose((function(){return null==t?void 0:t(mt.CLOSED)}));var s={},l={broadcast:a,presence:u,postgres_changes:null!==(r=null===(e=this.bindings.postgres_changes)||void 0===e?void 0:e.map((function(t){return t.filter})))&&void 0!==r?r:[],private:c};return this.socket.accessTokenValue&&(s.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},s)),this.joinedOnce=!0,this._rejoin(o),this.joinPush.receive("ok",function(){var e=xt(kt().mark((function e(r){var o,i,a,u,c,s,l,f,h,p,d,v,y;return kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.postgres_changes,n.socket.setAuth(),void 0!==o){e.next=7;break}return null==t||t(mt.SUBSCRIBED),e.abrupt("return");case 7:a=n.bindings.postgres_changes,u=null!==(i=null==a?void 0:a.length)&&void 0!==i?i:0,c=[],s=0;case 11:if(!(s<u)){e.next=25;break}if(l=a[s],f=l.filter,h=f.event,p=f.schema,d=f.table,v=f.filter,!(y=o&&o[s])||y.event!==h||y.schema!==p||y.table!==d||y.filter!==v){e.next=19;break}c.push(Object.assign(Object.assign({},l),{id:y.id})),e.next=22;break;case 19:return n.unsubscribe(),null==t||t(mt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")),e.abrupt("return");case 22:s++,e.next=11;break;case 25:return n.bindings.postgres_changes=c,t&&t(mt.SUBSCRIBED),e.abrupt("return");case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).receive("error",(function(e){null==t||t(mt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(e).join(", ")||"error")))})).receive("timeout",(function(){null==t||t(mt.TIMED_OUT)})),this}},{key:"presenceState",value:function(){return this.presence.state}},{key:"track",value:(u=xt(kt().mark((function t(e){var r,n=arguments;return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},t.next=3,this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"untrack",value:(a=xt(kt().mark((function t(){var e,r=arguments;return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:{},t.next=3,this.send({type:"presence",event:"untrack"},e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"on",value:function(t,e,r){return this._on(t,e,r)}},{key:"send",value:(i=xt(kt().mark((function t(e){var r,n,o,i,a,u,c,s,l=this,f=arguments;return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=f.length>1&&void 0!==f[1]?f[1]:{},this._canPush()||"broadcast"!==e.type){t.next=23;break}return i=e.event,a=e.payload,u=this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"",c={method:"POST",headers:{Authorization:u,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})},t.prev=5,t.next=8,this._fetchWithTimeout(this.broadcastEndpointURL,c,null!==(n=r.timeout)&&void 0!==n?n:this.timeout);case 8:return s=t.sent,t.next=11,null===(o=s.body)||void 0===o?void 0:o.cancel();case 11:return t.abrupt("return",s.ok?"ok":"error");case 14:if(t.prev=14,t.t0=t.catch(5),"AbortError"!==t.t0.name){t.next=20;break}return t.abrupt("return","timed out");case 20:return t.abrupt("return","error");case 21:t.next=24;break;case 23:return t.abrupt("return",new Promise((function(t){var n,o,i,a=l._push(e.type,e,r.timeout||l.timeout);"broadcast"!==e.type||(null===(i=null===(o=null===(n=l.params)||void 0===n?void 0:n.config)||void 0===o?void 0:o.broadcast)||void 0===i?void 0:i.ack)||t("ok"),a.receive("ok",(function(){return t("ok")})),a.receive("error",(function(){return t("error")})),a.receive("timeout",(function(){return t("timed out")}))})));case 24:case"end":return t.stop()}}),t,this,[[5,14]])}))),function(t){return i.apply(this,arguments)})},{key:"updateJoinPayload",value:function(t){this.joinPush.updatePayload(t)}},{key:"unsubscribe",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=G.leaving;var r=function(){t.socket.log("channel","leave ".concat(t.topic)),t._trigger(F.close,"leave",t._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((function(n){var o=new ft(t,F.leave,{},e);o.receive("ok",(function(){r(),n("ok")})).receive("timeout",(function(){r(),n("timed out")})).receive("error",(function(){n("error")})),o.send(),t._canPush()||o.trigger("ok",{})}))}},{key:"_fetchWithTimeout",value:(o=xt(kt().mark((function t(e,r,n){var o,i,a;return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=new AbortController,i=setTimeout((function(){return o.abort()}),n),t.next=4,this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:o.signal}));case 4:return a=t.sent,clearTimeout(i),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return o.apply(this,arguments)})},{key:"_push",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(t,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");var n=new ft(this,t,e,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}},{key:"_onMessage",value:function(t,e,r){return e}},{key:"_isMember",value:function(t){return this.topic===t}},{key:"_joinRef",value:function(){return this.joinPush.ref}},{key:"_trigger",value:function(t,e,r){var n,o,i=this,a=t.toLocaleLowerCase(),u=F.close,c=F.error,s=F.leave,l=F.join;if(!(r&&[u,c,s,l].indexOf(a)>=0&&r!==this._joinRef())){var f=this._onMessage(a,e,r);if(e&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter((function(t){var e,r,n;return"*"===(null===(e=t.filter)||void 0===e?void 0:e.event)||(null===(n=null===(r=t.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===a})).map((function(t){return t.callback(f,r)})):null===(o=this.bindings[a])||void 0===o||o.filter((function(t){var r,n,o,i,u,c;if(["broadcast","presence","postgres_changes"].includes(a)){if("id"in t){var s=t.id,l=null===(r=t.filter)||void 0===r?void 0:r.event;return s&&(null===(n=e.ids)||void 0===n?void 0:n.includes(s))&&("*"===l||(null==l?void 0:l.toLocaleLowerCase())===(null===(o=e.data)||void 0===o?void 0:o.type.toLocaleLowerCase()))}var f=null===(u=null===(i=null==t?void 0:t.filter)||void 0===i?void 0:i.event)||void 0===u?void 0:u.toLocaleLowerCase();return"*"===f||f===(null===(c=null==e?void 0:e.event)||void 0===c?void 0:c.toLocaleLowerCase())}return t.type.toLocaleLowerCase()===a})).map((function(t){if("object"===wt(f)&&"ids"in f){var e=f.data,n={schema:e.schema,table:e.table,commit_timestamp:e.commit_timestamp,eventType:e.type,new:{},old:{},errors:e.errors};f=Object.assign(Object.assign({},n),i._getPayloadRecords(e))}t.callback(f,r)}))}}},{key:"_isClosed",value:function(){return this.state===G.closed}},{key:"_isJoined",value:function(){return this.state===G.joined}},{key:"_isJoining",value:function(){return this.state===G.joining}},{key:"_isLeaving",value:function(){return this.state===G.leaving}},{key:"_replyEventName",value:function(t){return"chan_reply_".concat(t)}},{key:"_on",value:function(t,e,r){var n=t.toLocaleLowerCase(),o={type:n,filter:e,callback:r};return this.bindings[n]?this.bindings[n].push(o):this.bindings[n]=[o],this}},{key:"_off",value:function(e,r){var n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter((function(e){var o;return!((null===(o=e.type)||void 0===o?void 0:o.toLocaleLowerCase())===n&&t.isEqual(e.filter,r))})),this}},{key:"_rejoinUntilConnected",value:function(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}},{key:"_onClose",value:function(t){this._on(F.close,{},t)}},{key:"_onError",value:function(t){this._on(F.error,{},(function(e){return t(e)}))}},{key:"_canPush",value:function(){return this.socket.isConnected()&&this._isJoined()}},{key:"_rejoin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=G.joining,this.joinPush.resend(t))}},{key:"_getPayloadRecords",value:function(t){var e={new:{},old:{}};return"INSERT"!==t.type&&"UPDATE"!==t.type||(e.new=X(t.columns,t.record)),"UPDATE"!==t.type&&"DELETE"!==t.type||(e.old=X(t.columns,t.old_record)),e}}],n=[{key:"isEqual",value:function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(t[r]!==e[r])return!1;return!0}}],r&&Et(e.prototype,r),n&&Et(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n,o,i,a,u}();function Ot(t){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(t)}function Lt(){Lt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Ot(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ot(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Pt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Tt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Pt(i,n,o,a,u,"next",t)}function u(t){Pt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function At(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rt(n.key),n)}}function It(t,e,r){return e&&Ct(t.prototype,e),r&&Ct(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rt(t){var e=function(t){if("object"!=Ot(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ot(e)?e:e+""}var Nt=function(){},Gt="undefined"!=typeof WebSocket,Ft=function(){return It((function t(e,r){var n,o=this;At(this,t),this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=M,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Nt,this.conn=null,this.sendBuffer=[],this.serializer=new K,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=function(t){var e;return e=t||("undefined"==typeof fetch?function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Promise.resolve().then(a.bind(a,914)).then((function(t){return t.default.apply(void 0,e)}))}:fetch),function(){return e.apply(void 0,arguments)}},this.endPoint="".concat(e,"/").concat(U.websocket),this.httpEndpoint=at(e),(null==r?void 0:r.transport)?this.transport=r.transport:this.transport=null,(null==r?void 0:r.params)&&(this.params=r.params),(null==r?void 0:r.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),(null==r?void 0:r.timeout)&&(this.timeout=r.timeout),(null==r?void 0:r.logger)&&(this.logger=r.logger),(null==r?void 0:r.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);var i=null===(n=null==r?void 0:r.params)||void 0===n?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=(null==r?void 0:r.reconnectAfterMs)?r.reconnectAfterMs:function(t){return[1e3,2e3,5e3,1e4][t-1]||1e4},this.encode=(null==r?void 0:r.encode)?r.encode:function(t,e){return e(JSON.stringify(t))},this.decode=(null==r?void 0:r.decode)?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new $(Tt(Lt().mark((function t(){return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o.disconnect(),o.connect();case 2:case"end":return t.stop()}}),t)}))),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==r?void 0:r.fetch),null==r?void 0:r.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==r?void 0:r.worker)||!1,this.workerUrl=null==r?void 0:r.workerUrl}this.accessToken=(null==r?void 0:r.accessToken)||null}),[{key:"connect",value:function(){var t=this;if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(Gt)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new Ut(this.endpointURL(),void 0,{close:function(){t.conn=null}}),a.e(290).then(a.t.bind(a,290,23)).then((function(e){var r=e.default;t.conn=new r(t.endpointURL(),void 0,{headers:t.headers}),t.setupConnection()}))}}},{key:"endpointURL",value:function(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}},{key:"disconnect",value:function(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,null!=e?e:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}},{key:"getChannels",value:function(){return this.channels}},{key:"removeChannel",value:(o=Tt(Lt().mark((function t(e){var r;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.unsubscribe();case 2:return r=t.sent,0===this.channels.length&&this.disconnect(),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"removeAllChannels",value:(n=Tt(Lt().mark((function t(){var e;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.channels.map((function(t){return t.unsubscribe()})));case 2:return e=t.sent,this.disconnect(),t.abrupt("return",e);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"log",value:function(t,e,r){this.logger(t,e,r)}},{key:"connectionState",value:function(){switch(this.conn&&this.conn.readyState){case N.connecting:return D.Connecting;case N.open:return D.Open;case N.closing:return D.Closing;default:return D.Closed}}},{key:"isConnected",value:function(){return this.connectionState()===D.Open}},{key:"channel",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},r=new jt("realtime:".concat(t),e,this);return this.channels.push(r),r}},{key:"push",value:function(t){var e=this,r=t.topic,n=t.event,o=t.payload,i=t.ref,a=function(){e.encode(t,(function(t){var r;null===(r=e.conn)||void 0===r||r.send(t)}))};this.log("push","".concat(r," ").concat(n," (").concat(i,")"),o),this.isConnected()?a():this.sendBuffer.push(a)}},{key:"setAuth",value:(r=Tt(Lt().mark((function t(){var e,r,n,o=arguments;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=o.length>0&&void 0!==o[0]?o[0]:null,t.t1=e,t.t1){t.next=9;break}if(t.t2=this.accessToken,!t.t2){t.next=8;break}return t.next=7,this.accessToken();case 7:t.t2=t.sent;case 8:t.t1=t.t2;case 9:if(t.t0=t.t1,t.t0){t.next=12;break}t.t0=this.accessTokenValue;case 12:if(!(r=t.t0)){t.next=24;break}n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch(t){}if(!n||!n.exp){t.next=22;break}if(Math.floor(Date.now()/1e3)-n.exp<0){t.next=22;break}return this.log("auth",'InvalidJWTToken: Invalid value for JWT claim "exp" with value '.concat(n.exp)),t.abrupt("return",Promise.reject('InvalidJWTToken: Invalid value for JWT claim "exp" with value '.concat(n.exp)));case 22:this.accessTokenValue=r,this.channels.forEach((function(t){r&&t.updateJoinPayload({access_token:r}),t.joinedOnce&&t._isJoined()&&t._push(F.access_token,{access_token:r})}));case 24:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"sendHeartbeat",value:(e=Tt(Lt().mark((function t(){var e;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isConnected()){t.next=2;break}return t.abrupt("return");case 2:if(!this.pendingHeartbeatRef){t.next=7;break}return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"),t.abrupt("return");case 7:this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth();case 10:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"flushSendBuffer",value:function(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((function(t){return t()})),this.sendBuffer=[])}},{key:"_makeRef",value:function(){var t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}},{key:"_leaveOpenTopic",value:function(t){var e=this.channels.find((function(e){return e.topic===t&&(e._isJoined()||e._isJoining())}));e&&(this.log("transport",'leaving duplicate topic "'.concat(t,'"')),e.unsubscribe())}},{key:"_remove",value:function(t){this.channels=this.channels.filter((function(e){return e._joinRef()!==t._joinRef()}))}},{key:"setupConnection",value:function(){var t=this;this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=function(){return t._onConnOpen()},this.conn.onerror=function(e){return t._onConnError(e)},this.conn.onmessage=function(e){return t._onConnMessage(e)},this.conn.onclose=function(e){return t._onConnClose(e)})}},{key:"_onConnMessage",value:function(t){var e=this;this.decode(t.data,(function(t){var r=t.topic,n=t.event,o=t.payload,i=t.ref;i&&i===e.pendingHeartbeatRef&&(e.pendingHeartbeatRef=null),e.log("receive","".concat(o.status||""," ").concat(r," ").concat(n," ").concat(i&&"("+i+")"||""),o),e.channels.filter((function(t){return t._isMember(r)})).forEach((function(t){return t._trigger(n,o,i)})),e.stateChangeCallbacks.message.forEach((function(e){return e(t)}))}))}},{key:"_onConnOpen",value:(t=Tt(Lt().mark((function t(){var e,r=this;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.log("transport","connected to ".concat(this.endpointURL())),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?(this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker"),e=this._workerObjectUrl(this.workerUrl),this.workerRef=new Worker(e),this.workerRef.onerror=function(t){r.log("worker","worker error",t.message),r.workerRef.terminate()},this.workerRef.onmessage=function(t){"keepAlive"===t.data.event&&r.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})):(this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((function(){return r.sendHeartbeat()}),this.heartbeatIntervalMs)),this.stateChangeCallbacks.open.forEach((function(t){return t()}));case 5:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"_onConnClose",value:function(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((function(e){return e(t)}))}},{key:"_onConnError",value:function(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((function(e){return e(t)}))}},{key:"_triggerChanError",value:function(){this.channels.forEach((function(t){return t._trigger(F.error)}))}},{key:"_appendParams",value:function(t,e){if(0===Object.keys(e).length)return t;var r=t.match(/\?/)?"&":"?",n=new URLSearchParams(e);return"".concat(t).concat(r).concat(n)}},{key:"_workerObjectUrl",value:function(t){var e;if(t)e=t;else{var r=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});e=URL.createObjectURL(r)}return e}}]);var t,e,r,n,o}(),Ut=It((function t(e,r,n){At(this,t),this.binaryType="arraybuffer",this.onclose=function(){},this.onerror=function(){},this.onmessage=function(){},this.onopen=function(){},this.readyState=N.connecting,this.send=function(){},this.url=null,this.url=e,this.close=n.close}));function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Bt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qt(n.key),n)}}function Mt(t,e,r){return e&&Bt(t.prototype,e),r&&Bt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function qt(t){var e=function(t){if("object"!=Dt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Dt(e)?e:e+""}function Jt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zt(t,e,r){return e=Wt(e),function(t,e){if(e&&("object"==Dt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ht()?Reflect.construct(e,r||[],Wt(t).constructor):e.apply(t,r))}function Kt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yt(t,e)}function Vt(t){var e="function"==typeof Map?new Map:void 0;return Vt=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(Ht())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&Yt(o,r.prototype),o}(t,arguments,Wt(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Yt(r,t)},Vt(t)}function Ht(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ht=function(){return!!t})()}function Yt(t,e){return Yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yt(t,e)}function Wt(t){return Wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wt(t)}var $t=function(t){function e(t){var r;return Jt(this,e),(r=zt(this,e,[t])).__isStorageError=!0,r.name="StorageError",r}return Kt(e,t),Mt(e)}(Vt(Error));function Xt(t){return"object"===Dt(t)&&null!==t&&"__isStorageError"in t}var Qt=function(t){function e(t,r){var n;return Jt(this,e),(n=zt(this,e,[t])).name="StorageApiError",n.status=r,n}return Kt(e,t),Mt(e,[{key:"toJSON",value:function(){return{name:this.name,message:this.message,status:this.status}}}])}($t),Zt=function(t){function e(t,r){var n;return Jt(this,e),(n=zt(this,e,[t])).name="StorageUnknownError",n.originalError=r,n}return Kt(e,t),Mt(e)}($t);function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function re(){re=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==te(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(te(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}var ne=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},oe=function(t){var e;return e=t||("undefined"==typeof fetch?function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Promise.resolve().then(a.bind(a,914)).then((function(t){return t.default.apply(void 0,e)}))}:fetch),function(){return e.apply(void 0,arguments)}},ie=function(t){if(Array.isArray(t))return t.map((function(t){return ie(t)}));if("function"==typeof t||t!==Object(t))return t;var e={};return Object.entries(t).forEach((function(t){var r,n,o=(n=2,function(t){if(Array.isArray(t))return t}(r=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(r,n)||function(t,e){if(t){if("string"==typeof t)return ee(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(t,e):void 0}}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1],u=i.replace(/([-_][a-z])/gi,(function(t){return t.toUpperCase().replace(/[-_]/g,"")}));e[u]=ie(a)})),e};function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function ue(){ue=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==ae(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ae(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}var ce=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},se=function(t){return t.msg||t.message||t.error_description||t.error||JSON.stringify(t)},le=function(t,e,r){return ce(void 0,void 0,void 0,ue().mark((function n(){var o;return ue().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ne(void 0,void 0,void 0,re().mark((function t(){return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!=typeof Response){t.next=4;break}return t.next=3,Promise.resolve().then(a.bind(a,914));case 3:return t.abrupt("return",t.sent.Response);case 4:return t.abrupt("return",Response);case 5:case"end":return t.stop()}}),t)})));case 2:o=n.sent,t instanceof o&&!(null==r?void 0:r.noResolveJson)?t.json().then((function(r){e(new Qt(se(r),t.status||500))})).catch((function(t){e(new Zt(se(t),t))})):e(new Zt(se(t),t));case 4:case"end":return n.stop()}}),n)})))},fe=function(t,e,r,n){var o={method:t,headers:(null==e?void 0:e.headers)||{}};return"GET"===t?o:(o.headers=Object.assign({"Content-Type":"application/json"},null==e?void 0:e.headers),n&&(o.body=JSON.stringify(n)),Object.assign(Object.assign({},o),r))};function he(t,e,r,n,o,i){return ce(this,void 0,void 0,ue().mark((function a(){return ue().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise((function(a,u){t(r,fe(e,n,o,i)).then((function(t){if(!t.ok)throw t;return(null==n?void 0:n.noResolveJson)?t:t.json()})).then((function(t){return a(t)})).catch((function(t){return le(t,u,n)}))})));case 1:case"end":return a.stop()}}),a)})))}function pe(t,e,r,n){return ce(this,void 0,void 0,ue().mark((function o(){return ue().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",he(t,"GET",e,r,n));case 1:case"end":return o.stop()}}),o)})))}function de(t,e,r,n,o){return ce(this,void 0,void 0,ue().mark((function i(){return ue().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",he(t,"POST",e,n,o,r));case 1:case"end":return i.stop()}}),i)})))}function ve(t,e,r,n,o){return ce(this,void 0,void 0,ue().mark((function i(){return ue().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",he(t,"PUT",e,n,o,r));case 1:case"end":return i.stop()}}),i)})))}function ye(t,e,r,n){return ce(this,void 0,void 0,ue().mark((function o(){return ue().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",he(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n));case 1:case"end":return o.stop()}}),o)})))}function be(t,e,r,n,o){return ce(this,void 0,void 0,ue().mark((function i(){return ue().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",he(t,"DELETE",e,n,o,r));case 1:case"end":return i.stop()}}),i)})))}function me(t){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},me(t)}function ge(){ge=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==me(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(me(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function we(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ke(n.key),n)}}function ke(t){var e=function(t){if("object"!=me(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=me(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==me(e)?e:e+""}var _e=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},xe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ee={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},Se=function(){return t=function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=e,this.headers=r,this.bucketId=n,this.fetch=oe(o)},(e=[{key:"uploadOrUpdate",value:function(t,e,r,n){return _e(this,void 0,void 0,ge().mark((function o(){var i,a,u,c,s,l,f,h,p;return ge().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,a=Object.assign(Object.assign({},Ee),n),u=Object.assign(Object.assign({},this.headers),"POST"===t&&{"x-upsert":String(a.upsert)}),c=a.metadata,"undefined"!=typeof Blob&&r instanceof Blob?((i=new FormData).append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?((i=r).append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,u["cache-control"]="max-age=".concat(a.cacheControl),u["content-type"]=a.contentType,c&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),(null==n?void 0:n.headers)&&(u=Object.assign(Object.assign({},u),n.headers)),s=this._removeEmptyFolders(e),l=this._getFinalPath(s),o.next=10,this.fetch("".concat(this.url,"/object/").concat(l),Object.assign({method:t,body:i,headers:u},(null==a?void 0:a.duplex)?{duplex:a.duplex}:{}));case 10:return f=o.sent,o.next=13,f.json();case 13:if(h=o.sent,!f.ok){o.next=18;break}return o.abrupt("return",{data:{path:s,id:h.Id,fullPath:h.Key},error:null});case 18:return p=h,o.abrupt("return",{data:null,error:p});case 20:o.next=27;break;case 22:if(o.prev=22,o.t0=o.catch(0),!Xt(o.t0)){o.next=26;break}return o.abrupt("return",{data:null,error:o.t0});case 26:throw o.t0;case 27:case"end":return o.stop()}}),o,this,[[0,22]])})))}},{key:"upload",value:function(t,e,r){return _e(this,void 0,void 0,ge().mark((function n(){return ge().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.uploadOrUpdate("POST",t,e,r));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"uploadToSignedUrl",value:function(t,e,r,n){return _e(this,void 0,void 0,ge().mark((function o(){var i,a,u,c,s,l,f,h,p;return ge().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i=this._removeEmptyFolders(t),a=this._getFinalPath(i),(u=new URL(this.url+"/object/upload/sign/".concat(a))).searchParams.set("token",e),o.prev=4,s=Object.assign({upsert:Ee.upsert},n),l=Object.assign(Object.assign({},this.headers),{"x-upsert":String(s.upsert)}),"undefined"!=typeof Blob&&r instanceof Blob?((c=new FormData).append("cacheControl",s.cacheControl),c.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(c=r).append("cacheControl",s.cacheControl):(c=r,l["cache-control"]="max-age=".concat(s.cacheControl),l["content-type"]=s.contentType),o.next=10,this.fetch(u.toString(),{method:"PUT",body:c,headers:l});case 10:return f=o.sent,o.next=13,f.json();case 13:if(h=o.sent,!f.ok){o.next=18;break}return o.abrupt("return",{data:{path:i,fullPath:h.Key},error:null});case 18:return p=h,o.abrupt("return",{data:null,error:p});case 20:o.next=27;break;case 22:if(o.prev=22,o.t0=o.catch(4),!Xt(o.t0)){o.next=26;break}return o.abrupt("return",{data:null,error:o.t0});case 26:throw o.t0;case 27:case"end":return o.stop()}}),o,this,[[4,22]])})))}},{key:"createSignedUploadUrl",value:function(t,e){return _e(this,void 0,void 0,ge().mark((function r(){var n,o,i,a,u;return ge().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n=this._getFinalPath(t),o=Object.assign({},this.headers),(null==e?void 0:e.upsert)&&(o["x-upsert"]="true"),r.next=6,de(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(n),{},{headers:o});case 6:if(i=r.sent,a=new URL(this.url+i.url),u=a.searchParams.get("token")){r.next=11;break}throw new $t("No token returned by API");case 11:return r.abrupt("return",{data:{signedUrl:a.toString(),path:t,token:u},error:null});case 14:if(r.prev=14,r.t0=r.catch(0),!Xt(r.t0)){r.next=18;break}return r.abrupt("return",{data:null,error:r.t0});case 18:throw r.t0;case 19:case"end":return r.stop()}}),r,this,[[0,14]])})))}},{key:"update",value:function(t,e,r){return _e(this,void 0,void 0,ge().mark((function n(){return ge().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.uploadOrUpdate("PUT",t,e,r));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"move",value:function(t,e,r){return _e(this,void 0,void 0,ge().mark((function n(){var o;return ge().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,de(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers});case 3:return o=n.sent,n.abrupt("return",{data:o,error:null});case 7:if(n.prev=7,n.t0=n.catch(0),!Xt(n.t0)){n.next=11;break}return n.abrupt("return",{data:null,error:n.t0});case 11:throw n.t0;case 12:case"end":return n.stop()}}),n,this,[[0,7]])})))}},{key:"copy",value:function(t,e,r){return _e(this,void 0,void 0,ge().mark((function n(){var o;return ge().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,de(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers});case 3:return o=n.sent,n.abrupt("return",{data:{path:o.Key},error:null});case 7:if(n.prev=7,n.t0=n.catch(0),!Xt(n.t0)){n.next=11;break}return n.abrupt("return",{data:null,error:n.t0});case 11:throw n.t0;case 12:case"end":return n.stop()}}),n,this,[[0,7]])})))}},{key:"createSignedUrl",value:function(t,e,r){return _e(this,void 0,void 0,ge().mark((function n(){var o,i,a,u;return ge().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=this._getFinalPath(t),n.next=4,de(this.fetch,"".concat(this.url,"/object/sign/").concat(o),Object.assign({expiresIn:e},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});case 4:return i=n.sent,a=(null==r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"",u=encodeURI("".concat(this.url).concat(i.signedURL).concat(a)),i={signedUrl:u},n.abrupt("return",{data:i,error:null});case 11:if(n.prev=11,n.t0=n.catch(0),!Xt(n.t0)){n.next=15;break}return n.abrupt("return",{data:null,error:n.t0});case 15:throw n.t0;case 16:case"end":return n.stop()}}),n,this,[[0,11]])})))}},{key:"createSignedUrls",value:function(t,e,r){return _e(this,void 0,void 0,ge().mark((function n(){var o,i,a=this;return ge().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,de(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:e,paths:t},{headers:this.headers});case 3:return o=n.sent,i=(null==r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"",n.abrupt("return",{data:o.map((function(t){return Object.assign(Object.assign({},t),{signedUrl:t.signedURL?encodeURI("".concat(a.url).concat(t.signedURL).concat(i)):null})})),error:null});case 8:if(n.prev=8,n.t0=n.catch(0),!Xt(n.t0)){n.next=12;break}return n.abrupt("return",{data:null,error:n.t0});case 12:throw n.t0;case 13:case"end":return n.stop()}}),n,this,[[0,8]])})))}},{key:"download",value:function(t,e){return _e(this,void 0,void 0,ge().mark((function r(){var n,o,i,a,u,c,s;return ge().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=void 0!==(null==e?void 0:e.transform),o=n?"render/image/authenticated":"object",i=this.transformOptsToQueryString((null==e?void 0:e.transform)||{}),a=i?"?".concat(i):"",r.prev=4,u=this._getFinalPath(t),r.next=8,pe(this.fetch,"".concat(this.url,"/").concat(o,"/").concat(u).concat(a),{headers:this.headers,noResolveJson:!0});case 8:return c=r.sent,r.next=11,c.blob();case 11:return s=r.sent,r.abrupt("return",{data:s,error:null});case 15:if(r.prev=15,r.t0=r.catch(4),!Xt(r.t0)){r.next=19;break}return r.abrupt("return",{data:null,error:r.t0});case 19:throw r.t0;case 20:case"end":return r.stop()}}),r,this,[[4,15]])})))}},{key:"info",value:function(t){return _e(this,void 0,void 0,ge().mark((function e(){var r,n;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._getFinalPath(t),e.prev=1,e.next=4,pe(this.fetch,"".concat(this.url,"/object/info/").concat(r),{headers:this.headers});case 4:return n=e.sent,e.abrupt("return",{data:ie(n),error:null});case 8:if(e.prev=8,e.t0=e.catch(1),!Xt(e.t0)){e.next=12;break}return e.abrupt("return",{data:null,error:e.t0});case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,8]])})))}},{key:"exists",value:function(t){return _e(this,void 0,void 0,ge().mark((function e(){var r,n;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._getFinalPath(t),e.prev=1,e.next=4,ye(this.fetch,"".concat(this.url,"/object/").concat(r),{headers:this.headers});case 4:return e.abrupt("return",{data:!0,error:null});case 7:if(e.prev=7,e.t0=e.catch(1),!(Xt(e.t0)&&e.t0 instanceof Zt)){e.next=13;break}if(n=e.t0.originalError,![400,404].includes(null==n?void 0:n.status)){e.next=13;break}return e.abrupt("return",{data:!1,error:e.t0});case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,this,[[1,7]])})))}},{key:"getPublicUrl",value:function(t,e){var r=this._getFinalPath(t),n=[],o=(null==e?void 0:e.download)?"download=".concat(!0===e.download?"":e.download):"";""!==o&&n.push(o);var i=void 0!==(null==e?void 0:e.transform)?"render/image":"object",a=this.transformOptsToQueryString((null==e?void 0:e.transform)||{});""!==a&&n.push(a);var u=n.join("&");return""!==u&&(u="?".concat(u)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(i,"/public/").concat(r).concat(u))}}}},{key:"remove",value:function(t){return _e(this,void 0,void 0,ge().mark((function e(){var r;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:t},{headers:this.headers});case 3:return r=e.sent,e.abrupt("return",{data:r,error:null});case 7:if(e.prev=7,e.t0=e.catch(0),!Xt(e.t0)){e.next=11;break}return e.abrupt("return",{data:null,error:e.t0});case 11:throw e.t0;case 12:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"list",value:function(t,e,r){return _e(this,void 0,void 0,ge().mark((function n(){var o,i;return ge().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=Object.assign(Object.assign(Object.assign({},xe),e),{prefix:t||""}),n.next=4,de(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),o,{headers:this.headers},r);case 4:return i=n.sent,n.abrupt("return",{data:i,error:null});case 8:if(n.prev=8,n.t0=n.catch(0),!Xt(n.t0)){n.next=12;break}return n.abrupt("return",{data:null,error:n.t0});case 12:throw n.t0;case 13:case"end":return n.stop()}}),n,this,[[0,8]])})))}},{key:"encodeMetadata",value:function(t){return JSON.stringify(t)}},{key:"toBase64",value:function(t){return"undefined"!=typeof Buffer?Buffer.from(t).toString("base64"):btoa(t)}},{key:"_getFinalPath",value:function(t){return"".concat(this.bucketId,"/").concat(t)}},{key:"_removeEmptyFolders",value:function(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}},{key:"transformOptsToQueryString",value:function(t){var e=[];return t.width&&e.push("width=".concat(t.width)),t.height&&e.push("height=".concat(t.height)),t.resize&&e.push("resize=".concat(t.resize)),t.format&&e.push("format=".concat(t.format)),t.quality&&e.push("quality=".concat(t.quality)),e.join("&")}}])&&we(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),je={"X-Client-Info":"storage-js/".concat("2.7.1")};function Oe(t){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(t)}function Le(){Le=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Oe(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Oe(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Te(n.key),n)}}function Te(t){var e=function(t){if("object"!=Oe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Oe(e)?e:e+""}var Ae=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))};function Ce(t){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ce(t)}function Ie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Re(n.key),n)}}function Re(t){var e=function(t){if("object"!=Ce(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ce(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ce(e)?e:e+""}function Ne(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ne=function(){return!!t})()}function Ge(t){return Ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ge(t)}function Fe(t,e){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fe(t,e)}var Ue,De=function(t){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Ge(e),function(t,e){if(e&&("object"==Ce(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ne()?Reflect.construct(e,r||[],Ge(t).constructor):e.apply(t,r))}(this,e,[t,r,n])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fe(t,e)}(e,t),r=e,(n=[{key:"from",value:function(t){return new Se(this.url,this.headers,t,this.fetch)}}])&&Ie(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(function(){return t=function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=e,this.headers=Object.assign(Object.assign({},je),r),this.fetch=oe(n)},e=[{key:"listBuckets",value:function(){return Ae(this,void 0,void 0,Le().mark((function t(){var e;return Le().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,pe(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers});case 3:return e=t.sent,t.abrupt("return",{data:e,error:null});case 7:if(t.prev=7,t.t0=t.catch(0),!Xt(t.t0)){t.next=11;break}return t.abrupt("return",{data:null,error:t.t0});case 11:throw t.t0;case 12:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"getBucket",value:function(t){return Ae(this,void 0,void 0,Le().mark((function e(){var r;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,pe(this.fetch,"".concat(this.url,"/bucket/").concat(t),{headers:this.headers});case 3:return r=e.sent,e.abrupt("return",{data:r,error:null});case 7:if(e.prev=7,e.t0=e.catch(0),!Xt(e.t0)){e.next=11;break}return e.abrupt("return",{data:null,error:e.t0});case 11:throw e.t0;case 12:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"createBucket",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return Ae(this,void 0,void 0,Le().mark((function r(){var n;return Le().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,de(this.fetch,"".concat(this.url,"/bucket"),{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers});case 3:return n=r.sent,r.abrupt("return",{data:n,error:null});case 7:if(r.prev=7,r.t0=r.catch(0),!Xt(r.t0)){r.next=11;break}return r.abrupt("return",{data:null,error:r.t0});case 11:throw r.t0;case 12:case"end":return r.stop()}}),r,this,[[0,7]])})))}},{key:"updateBucket",value:function(t,e){return Ae(this,void 0,void 0,Le().mark((function r(){var n;return Le().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,ve(this.fetch,"".concat(this.url,"/bucket/").concat(t),{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers});case 3:return n=r.sent,r.abrupt("return",{data:n,error:null});case 7:if(r.prev=7,r.t0=r.catch(0),!Xt(r.t0)){r.next=11;break}return r.abrupt("return",{data:null,error:r.t0});case 11:throw r.t0;case 12:case"end":return r.stop()}}),r,this,[[0,7]])})))}},{key:"emptyBucket",value:function(t){return Ae(this,void 0,void 0,Le().mark((function e(){var r;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,de(this.fetch,"".concat(this.url,"/bucket/").concat(t,"/empty"),{},{headers:this.headers});case 3:return r=e.sent,e.abrupt("return",{data:r,error:null});case 7:if(e.prev=7,e.t0=e.catch(0),!Xt(e.t0)){e.next=11;break}return e.abrupt("return",{data:null,error:e.t0});case 11:throw e.t0;case 12:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"deleteBucket",value:function(t){return Ae(this,void 0,void 0,Le().mark((function e(){var r;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be(this.fetch,"".concat(this.url,"/bucket/").concat(t),{},{headers:this.headers});case 3:return r=e.sent,e.abrupt("return",{data:r,error:null});case 7:if(e.prev=7,e.t0=e.catch(0),!Xt(e.t0)){e.next=11;break}return e.abrupt("return",{data:null,error:e.t0});case 11:throw e.t0;case 12:case"end":return e.stop()}}),e,this,[[0,7]])})))}}],e&&Pe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}());Ue="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";var Be={headers:{"X-Client-Info":"supabase-js-".concat(Ue,"/").concat("2.47.10")}},Me={schema:"public"},qe={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Je={},ze=a(914);function Ke(t){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(t)}function Ve(){Ve=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Ke(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ke(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}var He=function(t){var e;return e=t||("undefined"==typeof fetch?ze.default:fetch),function(){return e.apply(void 0,arguments)}},Ye=function(t,e,r){var n=He(r),o="undefined"==typeof Headers?ze.Headers:Headers;return function(r,i){return a=void 0,u=void 0,c=void 0,s=Ve().mark((function a(){var u,c,s;return Ve().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e();case 2:if(a.t1=u=a.sent,a.t0=null!==a.t1,!a.t0){a.next=6;break}a.t0=void 0!==u;case 6:if(!a.t0){a.next=10;break}a.t2=u,a.next=11;break;case 10:a.t2=t;case 11:return c=a.t2,(s=new o(null==i?void 0:i.headers)).has("apikey")||s.set("apikey",t),s.has("Authorization")||s.set("Authorization","Bearer ".concat(c)),a.abrupt("return",n(r,Object.assign(Object.assign({},i),{headers:s})));case 16:case"end":return a.stop()}}),a)})),new(c||(c=Promise))((function(t,e){function r(t){try{o(s.next(t))}catch(t){e(t)}}function n(t){try{o(s.throw(t))}catch(t){e(t)}}function o(e){var o;e.done?t(e.value):(o=e.value,o instanceof c?o:new c((function(t){t(o)}))).then(r,n)}o((s=s.apply(a,u||[])).next())}));var a,u,c,s}};function We(t){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},We(t)}function $e(){$e=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==We(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(We(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}var Xe="2.67.3",Qe={"X-Client-Info":"gotrue-js/".concat(Xe)},Ze="X-Supabase-Api-Version",tr=Date.parse("2024-01-01T00:00:00.0Z"),er="2024-01-01";function rr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,or(n.key),n)}}function nr(t,e,r){return e&&rr(t.prototype,e),r&&rr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function or(t){var e=function(t){if("object"!=cr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=cr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==cr(e)?e:e+""}function ir(){ir=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==cr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(cr(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ar(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function ur(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ar(i,n,o,a,u,"next",t)}function u(t){ar(i,n,o,a,u,"throw",t)}a(void 0)}))}}function cr(t){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cr(t)}var sr=function(){return"undefined"!=typeof window&&"undefined"!=typeof document},lr={tested:!1,writable:!1},fr=function(){if(!sr())return!1;try{if("object"!==cr(globalThis.localStorage))return!1}catch(t){return!1}if(lr.tested)return lr.writable;var t="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),lr.tested=!0,lr.writable=!0}catch(t){lr.tested=!0,lr.writable=!1}return lr.writable};function hr(t){var e={},r=new URL(t);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((function(t,r){e[r]=t}))}catch(t){}return r.searchParams.forEach((function(t,r){e[r]=t})),e}var pr=function(t){var e;return e=t||("undefined"==typeof fetch?function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Promise.resolve().then(a.bind(a,914)).then((function(t){return t.default.apply(void 0,e)}))}:fetch),function(){return e.apply(void 0,arguments)}},dr=function(){var t=ur(ir().mark((function t(e,r,n){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setItem(r,JSON.stringify(n));case 2:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),vr=function(){var t=ur(ir().mark((function t(e,r){var n;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getItem(r);case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",null);case 5:return t.prev=5,t.abrupt("return",JSON.parse(n));case 9:return t.prev=9,t.t0=t.catch(5),t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,null,[[5,9]])})));return function(e,r){return t.apply(this,arguments)}}(),yr=function(){var t=ur(ir().mark((function t(e,r){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.removeItem(r);case 2:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),br=nr((function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.promise=new t.promiseConstructor((function(t,r){e.resolve=t,e.reject=r}))}));function mr(t){var e=t.split(".");if(3!==e.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");var r=e[1];return JSON.parse(function(t){var e,r,n,o,i,a,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",s=0;for(t=t.replace("-","+").replace("_","/");s<t.length;)e=u.indexOf(t.charAt(s++))<<2|(o=u.indexOf(t.charAt(s++)))>>4,r=(15&o)<<4|(i=u.indexOf(t.charAt(s++)))>>2,n=(3&i)<<6|(a=u.indexOf(t.charAt(s++))),c+=String.fromCharCode(e),64!=i&&0!=r&&(c+=String.fromCharCode(r)),64!=a&&0!=n&&(c+=String.fromCharCode(n));return c}(r))}function gr(t){return wr.apply(this,arguments)}function wr(){return(wr=ur(ir().mark((function t(e){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){setTimeout((function(){return t(null)}),e)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function kr(t,e){return new Promise((function(r,n){ur(ir().mark((function o(){var i,a;return ir().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:i=0;case 1:if(!(i<1/0)){o.next=19;break}return o.prev=2,o.next=5,t(i);case 5:if(a=o.sent,e(i,null,a)){o.next=9;break}return r(a),o.abrupt("return");case 9:o.next=16;break;case 11:if(o.prev=11,o.t0=o.catch(2),e(i,o.t0)){o.next=16;break}return n(o.t0),o.abrupt("return");case 16:i++,o.next=1;break;case 19:case"end":return o.stop()}}),o,null,[[2,11]])})))()}))}function _r(t){return("0"+t.toString(16)).substr(-2)}function xr(){var t=new Uint32Array(56);if("undefined"==typeof crypto){for(var e="",r=0;r<56;r++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~".charAt(Math.floor(66*Math.random()));return e}return crypto.getRandomValues(t),Array.from(t,_r).join("")}function Er(t){return Sr.apply(this,arguments)}function Sr(){return(Sr=ur(ir().mark((function t(e){var r,n,o,i;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new TextEncoder,n=r.encode(e),t.next=4,crypto.subtle.digest("SHA-256",n);case 4:return o=t.sent,i=new Uint8Array(o),t.abrupt("return",Array.from(i).map((function(t){return String.fromCharCode(t)})).join(""));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function jr(t){return Or.apply(this,arguments)}function Or(){return(Or=ur(ir().mark((function t(e){var r;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder){t.next=4;break}return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t.abrupt("return",e);case 4:return t.next=6,Er(e);case 6:return r=t.sent,t.abrupt("return",btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Lr(t,e){return Pr.apply(this,arguments)}function Pr(){return Pr=ur(ir().mark((function t(e,r){var n,o,i,a,u,c=arguments;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=c.length>2&&void 0!==c[2]&&c[2],o=xr(),i=o,n&&(i+="/PASSWORD_RECOVERY"),t.next=6,dr(e,"".concat(r,"-code-verifier"),i);case 6:return t.next=8,jr(o);case 8:return a=t.sent,u=o===a?"plain":"s256",t.abrupt("return",[a,u]);case 11:case"end":return t.stop()}}),t)}))),Pr.apply(this,arguments)}br.promiseConstructor=Promise;var Tr=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ar(t){var e=t.headers.get(Ze);if(!e)return null;if(!e.match(Tr))return null;try{return new Date("".concat(e,"T00:00:00.0Z"))}catch(t){return null}}function Cr(t){return Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cr(t)}function Ir(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nr(n.key),n)}}function Rr(t,e,r){return e&&Ir(t.prototype,e),r&&Ir(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nr(t){var e=function(t){if("object"!=Cr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Cr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Cr(e)?e:e+""}function Gr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fr(t,e,r){return e=qr(e),function(t,e){if(e&&("object"==Cr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Br()?Reflect.construct(e,r||[],qr(t).constructor):e.apply(t,r))}function Ur(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mr(t,e)}function Dr(t){var e="function"==typeof Map?new Map:void 0;return Dr=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(Br())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&Mr(o,r.prototype),o}(t,arguments,qr(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Mr(r,t)},Dr(t)}function Br(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Br=function(){return!!t})()}function Mr(t,e){return Mr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mr(t,e)}function qr(t){return qr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qr(t)}var Jr=function(t){function e(t,r,n){var o;return Gr(this,e),(o=Fr(this,e,[t])).__isAuthError=!0,o.name="AuthError",o.status=r,o.code=n,o}return Ur(e,t),Rr(e)}(Dr(Error));function zr(t){return"object"===Cr(t)&&null!==t&&"__isAuthError"in t}var Kr=function(t){function e(t,r,n){var o;return Gr(this,e),(o=Fr(this,e,[t,r,n])).name="AuthApiError",o.status=r,o.code=n,o}return Ur(e,t),Rr(e)}(Jr);function Vr(t){return zr(t)&&"AuthApiError"===t.name}var Hr=function(t){function e(t,r){var n;return Gr(this,e),(n=Fr(this,e,[t])).name="AuthUnknownError",n.originalError=r,n}return Ur(e,t),Rr(e)}(Jr),Yr=function(t){function e(t,r,n,o){var i;return Gr(this,e),(i=Fr(this,e,[t,n,o])).name=r,i.status=n,i}return Ur(e,t),Rr(e)}(Jr),Wr=function(t){function e(){return Gr(this,e),Fr(this,e,["Auth session missing!","AuthSessionMissingError",400,void 0])}return Ur(e,t),Rr(e)}(Yr),$r=function(t){function e(){return Gr(this,e),Fr(this,e,["Auth session or user missing","AuthInvalidTokenResponseError",500,void 0])}return Ur(e,t),Rr(e)}(Yr),Xr=function(t){function e(t){return Gr(this,e),Fr(this,e,[t,"AuthInvalidCredentialsError",400,void 0])}return Ur(e,t),Rr(e)}(Yr),Qr=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Gr(this,e),(r=Fr(this,e,[t,"AuthImplicitGrantRedirectError",500,void 0])).details=null,r.details=n,r}return Ur(e,t),Rr(e,[{key:"toJSON",value:function(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}])}(Yr);function Zr(t){return zr(t)&&"AuthImplicitGrantRedirectError"===t.name}var tn=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Gr(this,e),(r=Fr(this,e,[t,"AuthPKCEGrantCodeExchangeError",500,void 0])).details=null,r.details=n,r}return Ur(e,t),Rr(e,[{key:"toJSON",value:function(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}])}(Yr),en=function(t){function e(t,r){return Gr(this,e),Fr(this,e,[t,"AuthRetryableFetchError",r,void 0])}return Ur(e,t),Rr(e)}(Yr);function rn(t){return zr(t)&&"AuthRetryableFetchError"===t.name}var nn=function(t){function e(t,r,n){var o;return Gr(this,e),(o=Fr(this,e,[t,"AuthWeakPasswordError",r,"weak_password"])).reasons=n,o}return Ur(e,t),Rr(e)}(Yr);function on(){on=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==an(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(an(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function an(t){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},an(t)}function un(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function cn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){un(i,n,o,a,u,"next",t)}function u(t){un(i,n,o,a,u,"throw",t)}a(void 0)}))}}var sn=function(t){return t.msg||t.message||t.error_description||t.error||JSON.stringify(t)},ln=[502,503,504];function fn(t){return hn.apply(this,arguments)}function hn(){return(hn=cn(on().mark((function t(e){var r,n,o,i;return on().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("object"===cr(a=e)&&null!==a&&"status"in a&&"ok"in a&&"json"in a&&"function"==typeof a.json){t.next=2;break}throw new en(sn(e),0);case 2:if(!ln.includes(e.status)){t.next=4;break}throw new en(sn(e),e.status);case 4:return t.prev=4,t.next=7,e.json();case 7:n=t.sent,t.next=13;break;case 10:throw t.prev=10,t.t0=t.catch(4),new Hr(sn(t.t0),t.t0);case 13:if(o=void 0,(i=Ar(e))&&i.getTime()>=tr&&"object"===an(n)&&n&&"string"==typeof n.code?o=n.code:"object"===an(n)&&n&&"string"==typeof n.error_code&&(o=n.error_code),o){t.next=21;break}if(!("object"===an(n)&&n&&"object"===an(n.weak_password)&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((function(t,e){return t&&"string"==typeof e}),!0))){t.next=19;break}throw new nn(sn(n),e.status,n.weak_password.reasons);case 19:t.next=27;break;case 21:if("weak_password"!==o){t.next=25;break}throw new nn(sn(n),e.status,(null===(r=n.weak_password)||void 0===r?void 0:r.reasons)||[]);case 25:if("session_not_found"!==o){t.next=27;break}throw new Wr;case 27:throw new Kr(sn(n),e.status||500,o);case 28:case"end":return t.stop()}var a}),t,null,[[4,10]])})))).apply(this,arguments)}var pn=function(t,e,r,n){var o={method:t,headers:(null==e?void 0:e.headers)||{}};return"GET"===t?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==e?void 0:e.headers),o.body=JSON.stringify(n),Object.assign(Object.assign({},o),r))};function dn(t,e,r,n){return vn.apply(this,arguments)}function vn(){return(vn=cn(on().mark((function t(e,r,n,o){var i,a,u,c,s;return on().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=Object.assign({},null==o?void 0:o.headers))[Ze]||(a[Ze]=er),(null==o?void 0:o.jwt)&&(a.Authorization="Bearer ".concat(o.jwt)),u=null!==(i=null==o?void 0:o.query)&&void 0!==i?i:{},(null==o?void 0:o.redirectTo)&&(u.redirect_to=o.redirectTo),c=Object.keys(u).length?"?"+new URLSearchParams(u).toString():"",t.next=8,yn(e,r,n+c,{headers:a,noResolveJson:null==o?void 0:o.noResolveJson},{},null==o?void 0:o.body);case 8:return s=t.sent,t.abrupt("return",(null==o?void 0:o.xform)?null==o?void 0:o.xform(s):{data:Object.assign({},s),error:null});case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yn(t,e,r,n,o,i){return bn.apply(this,arguments)}function bn(){return(bn=cn(on().mark((function t(e,r,n,o,i,a){var u,c;return on().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=pn(r,o,i,a),t.prev=1,t.next=4,e(n,Object.assign({},u));case 4:c=t.sent,t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(1),console.error(t.t0),new en(sn(t.t0),0);case 11:if(c.ok){t.next=14;break}return t.next=14,fn(c);case 14:if(!(null==o?void 0:o.noResolveJson)){t.next=16;break}return t.abrupt("return",c);case 16:return t.prev=16,t.next=19,c.json();case 19:return t.abrupt("return",t.sent);case 22:return t.prev=22,t.t1=t.catch(16),t.next=26,fn(t.t1);case 26:case"end":return t.stop()}}),t,null,[[1,7],[16,22]])})))).apply(this,arguments)}function mn(t){var e,r,n=null;return function(t){return t.access_token&&t.refresh_token&&t.expires_in}(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=(r=t.expires_in,Math.round(Date.now()/1e3)+r))),{data:{session:n,user:null!==(e=t.user)&&void 0!==e?e:t},error:null}}function gn(t){var e=mn(t);return!e.error&&t.weak_password&&"object"===an(t.weak_password)&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&"string"==typeof t.weak_password.message&&t.weak_password.reasons.reduce((function(t,e){return t&&"string"==typeof e}),!0)&&(e.data.weak_password=t.weak_password),e}function wn(t){var e;return{data:{user:null!==(e=t.user)&&void 0!==e?e:t},error:null}}function kn(t){return{data:t,error:null}}function _n(t){var e=t.action_link,r=t.email_otp,n=t.hashed_token,o=t.redirect_to,i=t.verification_type,a=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:e,email_otp:r,hashed_token:n,redirect_to:o,verification_type:i},user:Object.assign({},a)},error:null}}function xn(t){return t}function En(t){return En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},En(t)}function Sn(){Sn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==En(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(En(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function jn(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function On(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){jn(i,n,o,a,u,"next",t)}function u(t){jn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Ln(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pn(n.key),n)}}function Pn(t){var e=function(t){if("object"!=En(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=En(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==En(e)?e:e+""}var Tn=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r},An=function(){return t=function t(e){var r=e.url,n=void 0===r?"":r,o=e.headers,i=void 0===o?{}:o,a=e.fetch;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=n,this.headers=i,this.fetch=pr(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}},e=[{key:"signOut",value:(f=On(Sn().mark((function t(e){var r,n=arguments;return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:"global",t.prev=1,t.next=4,dn(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(r),{headers:this.headers,jwt:e,noResolveJson:!0});case 4:return t.abrupt("return",{data:null,error:null});case 7:if(t.prev=7,t.t0=t.catch(1),!zr(t.t0)){t.next=11;break}return t.abrupt("return",{data:null,error:t.t0});case 11:throw t.t0;case 12:case"end":return t.stop()}}),t,this,[[1,7]])}))),function(t){return f.apply(this,arguments)})},{key:"inviteUserByEmail",value:(l=On(Sn().mark((function t(e){var r,n=arguments;return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},t.prev=1,t.next=4,dn(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:wn});case 4:return t.abrupt("return",t.sent);case 7:if(t.prev=7,t.t0=t.catch(1),!zr(t.t0)){t.next=11;break}return t.abrupt("return",{data:{user:null},error:t.t0});case 11:throw t.t0;case 12:case"end":return t.stop()}}),t,this,[[1,7]])}))),function(t){return l.apply(this,arguments)})},{key:"generateLink",value:(s=On(Sn().mark((function t(e){var r,n,o;return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.options,n=Tn(e,["options"]),o=Object.assign(Object.assign({},n),r),"newEmail"in n&&(o.new_email=null==n?void 0:n.newEmail,delete o.newEmail),t.next=6,dn(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:o,headers:this.headers,xform:_n,redirectTo:null==r?void 0:r.redirectTo});case 6:return t.abrupt("return",t.sent);case 9:if(t.prev=9,t.t0=t.catch(0),!zr(t.t0)){t.next=13;break}return t.abrupt("return",{data:{properties:null,user:null},error:t.t0});case 13:throw t.t0;case 14:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(t){return s.apply(this,arguments)})},{key:"createUser",value:(c=On(Sn().mark((function t(e){return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dn(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:wn});case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),!zr(t.t0)){t.next=10;break}return t.abrupt("return",{data:{user:null},error:t.t0});case 10:throw t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return c.apply(this,arguments)})},{key:"listUsers",value:(u=On(Sn().mark((function t(e){var r,n,o,i,a,u,c,s,l,f,h,p;return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s={nextPage:null,lastPage:0,total:0},t.next=4,dn(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(r=null==e?void 0:e.page)||void 0===r?void 0:r.toString())&&void 0!==n?n:"",per_page:null!==(i=null===(o=null==e?void 0:e.perPage)||void 0===o?void 0:o.toString())&&void 0!==i?i:""},xform:xn});case 4:if(!(l=t.sent).error){t.next=7;break}throw l.error;case 7:return t.next=9,l.json();case 9:return f=t.sent,h=null!==(a=l.headers.get("x-total-count"))&&void 0!==a?a:0,(p=null!==(c=null===(u=l.headers.get("link"))||void 0===u?void 0:u.split(","))&&void 0!==c?c:[]).length>0&&(p.forEach((function(t){var e=parseInt(t.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(t.split(";")[1].split("=")[1]);s["".concat(r,"Page")]=e})),s.total=parseInt(h)),t.abrupt("return",{data:Object.assign(Object.assign({},f),s),error:null});case 16:if(t.prev=16,t.t0=t.catch(0),!zr(t.t0)){t.next=20;break}return t.abrupt("return",{data:{users:[]},error:t.t0});case 20:throw t.t0;case 21:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(t){return u.apply(this,arguments)})},{key:"getUserById",value:(a=On(Sn().mark((function t(e){return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dn(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:wn});case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),!zr(t.t0)){t.next=10;break}return t.abrupt("return",{data:{user:null},error:t.t0});case 10:throw t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return a.apply(this,arguments)})},{key:"updateUserById",value:(i=On(Sn().mark((function t(e,r){return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dn(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:r,headers:this.headers,xform:wn});case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),!zr(t.t0)){t.next=10;break}return t.abrupt("return",{data:{user:null},error:t.t0});case 10:throw t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t,e){return i.apply(this,arguments)})},{key:"deleteUser",value:(o=On(Sn().mark((function t(e){var r,n=arguments;return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]&&n[1],t.prev=1,t.next=4,dn(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:r},xform:wn});case 4:return t.abrupt("return",t.sent);case 7:if(t.prev=7,t.t0=t.catch(1),!zr(t.t0)){t.next=11;break}return t.abrupt("return",{data:{user:null},error:t.t0});case 11:throw t.t0;case 12:case"end":return t.stop()}}),t,this,[[1,7]])}))),function(t){return o.apply(this,arguments)})},{key:"_listFactors",value:(n=On(Sn().mark((function t(e){var r,n,o;return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dn(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:function(t){return{data:{factors:t},error:null}}});case 3:return r=t.sent,n=r.data,o=r.error,t.abrupt("return",{data:n,error:o});case 9:if(t.prev=9,t.t0=t.catch(0),!zr(t.t0)){t.next=13;break}return t.abrupt("return",{data:null,error:t.t0});case 13:throw t.t0;case 14:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(t){return n.apply(this,arguments)})},{key:"_deleteFactor",value:(r=On(Sn().mark((function t(e){var r;return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dn(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers});case 3:return r=t.sent,t.abrupt("return",{data:r,error:null});case 7:if(t.prev=7,t.t0=t.catch(0),!zr(t.t0)){t.next=11;break}return t.abrupt("return",{data:null,error:t.t0});case 11:throw t.t0;case 12:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return r.apply(this,arguments)})}],e&&Ln(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,u,c,s,l,f}(),Cn={getItem:function(t){return fr()?globalThis.localStorage.getItem(t):null},setItem:function(t,e){fr()&&globalThis.localStorage.setItem(t,e)},removeItem:function(t){fr()&&globalThis.localStorage.removeItem(t)}};function In(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:function(e){return t[e]||null},setItem:function(e,r){t[e]=r},removeItem:function(e){delete t[e]}}}function Rn(t){return Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rn(t)}function Nn(t){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn(t)}function Gn(){Gn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Nn(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Nn(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Fn(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Un(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Fn(i,n,o,a,u,"next",t)}function u(t){Fn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Dn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mn(n.key),n)}}function Bn(t,e,r){return e&&Dn(t.prototype,e),r&&Dn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Mn(t){var e=function(t){if("object"!=Nn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Nn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nn(e)?e:e+""}function qn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jn(t,e,r){return e=Yn(e),function(t,e){if(e&&("object"==Nn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Vn()?Reflect.construct(e,r||[],Yn(t).constructor):e.apply(t,r))}function zn(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hn(t,e)}function Kn(t){var e="function"==typeof Map?new Map:void 0;return Kn=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(Vn())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&Hn(o,r.prototype),o}(t,arguments,Yn(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Hn(r,t)},Kn(t)}function Vn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Vn=function(){return!!t})()}function Hn(t,e){return Hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Hn(t,e)}function Yn(t){return Yn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yn(t)}var Wn=!!(globalThis&&fr()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")),$n=function(t){function e(t){var r;return qn(this,e),(r=Jn(this,e,[t])).isAcquireTimeout=!0,r}return zn(e,t),Bn(e)}(Kn(Error)),Xn=function(t){function e(){return qn(this,e),Jn(this,e,arguments)}return zn(e,t),Bn(e)}($n);function Qn(t,e,r){return Zn.apply(this,arguments)}function Zn(){return Zn=Un(Gn().mark((function t(e,r,n){var o;return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Wn&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,r),o=new globalThis.AbortController,r>0&&setTimeout((function(){o.abort(),Wn&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),r),t.next=5,Promise.resolve().then((function(){return globalThis.navigator.locks.request(e,0===r?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},function(){var t=Un(Gn().mark((function t(o){var i;return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o){t.next=11;break}return Wn&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,o.name),t.prev=2,t.next=5,n();case 5:return t.abrupt("return",t.sent);case 6:return t.prev=6,Wn&&console.log("@supabase/gotrue-js: navigatorLock: released",e,o.name),t.finish(6);case 9:t.next=31;break;case 11:if(0!==r){t.next=16;break}throw Wn&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Xn('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));case 16:if(!Wn){t.next=27;break}return t.prev=17,t.next=20,globalThis.navigator.locks.query();case 20:i=t.sent,console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  ")),t.next=27;break;case 24:t.prev=24,t.t0=t.catch(17),console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",t.t0);case 27:return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),t.next=30,n();case 30:return t.abrupt("return",t.sent);case 31:case"end":return t.stop()}}),t,null,[[2,,6,9],[17,24]])})));return function(e){return t.apply(this,arguments)}}())}));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)}))),Zn.apply(this,arguments)}function to(t){return to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},to(t)}function eo(t){return function(t){if(Array.isArray(t))return oo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||no(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ro(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||no(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function no(t,e){if(t){if("string"==typeof t)return oo(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?oo(t,e):void 0}}function oo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function io(){io=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==to(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(to(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ao(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uo(n.key),n)}}function uo(t){var e=function(t){if("object"!=to(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=to(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==to(e)?e:e+""}function co(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function so(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){co(i,n,o,a,u,"next",t)}function u(t){co(i,n,o,a,u,"throw",t)}a(void 0)}))}}!function(){if("object"!==("undefined"==typeof globalThis?"undefined":Rn(globalThis)))try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(t){"undefined"!=typeof self&&(self.globalThis=self)}}();var lo={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Qe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},fo=3e4;function ho(t,e,r){return po.apply(this,arguments)}function po(){return(po=so(io().mark((function t(e,r,n){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var vo=function(){return t=function t(e){var r,n,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=t.nextInstanceID,t.nextInstanceID+=1,this.instanceID>0&&sr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");var i=Object.assign(Object.assign({},lo),e);if(this.logDebugMessages=!!i.debug,"function"==typeof i.debug&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new An({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=pr(i.fetch),this.lock=i.lock||ho,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:sr()&&(null===(r=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===r?void 0:r.locks)?this.lock=Qn:this.lock=ho,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:fr()?this.storage=Cn:(this.memoryStorage={},this.storage=In(this.memoryStorage)):(this.memoryStorage={},this.storage=In(this.memoryStorage)),sr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(t){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",t)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",function(){var t=so(io().mark((function t(e){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o._debug("received broadcast notification from other tab or client",e),t.next=3,o._notifyAllSubscribers(e.data.event,e.data.session,!1);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}this.initialize()},e=[{key:"_debug",value:function(){if(this.logDebugMessages){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logger.apply(this,["GoTrueClient@".concat(this.instanceID," (").concat(Xe,") ").concat((new Date).toISOString())].concat(e))}return this}},{key:"initialize",value:(it=so(io().mark((function t(){var e=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initializePromise){t.next=4;break}return t.next=3,this.initializePromise;case 3:case 7:return t.abrupt("return",t.sent);case 4:return this.initializePromise=so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._initialize();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))(),t.next=7,this.initializePromise;case 8:case"end":return t.stop()}}),t,this)}))),function(){return it.apply(this,arguments)})},{key:"_initialize",value:(ot=so(io().mark((function t(){var e,r,n,o,i,a,u,c,s,l=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=hr(window.location.href),n="none",!this._isImplicitGrantCallback(r)){t.next=7;break}n="implicit",t.next=11;break;case 7:return t.next=9,this._isPKCECallback(r);case 9:if(!t.sent){t.next=11;break}n="pkce";case 11:if(!sr()||!this.detectSessionInUrl||"none"===n){t.next=32;break}return t.next=14,this._getSessionFromURL(r,n);case 14:if(o=t.sent,i=o.data,!(a=o.error)){t.next=26;break}if(this._debug("#_initialize()","error detecting session from URL",a),!Zr(a)){t.next=23;break}if("identity_already_exists"!==(u=null===(e=a.details)||void 0===e?void 0:e.code)&&"identity_not_found"!==u&&"single_identity_not_deletable"!==u){t.next=23;break}return t.abrupt("return",{error:a});case 23:return t.next=25,this._removeSession();case 25:return t.abrupt("return",{error:a});case 26:return c=i.session,s=i.redirectType,this._debug("#_initialize()","detected session in URL",c,"redirect type",s),t.next=30,this._saveSession(c);case 30:return setTimeout(so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("recovery"!==s){t.next=5;break}return t.next=3,l._notifyAllSubscribers("PASSWORD_RECOVERY",c);case 3:t.next=7;break;case 5:return t.next=7,l._notifyAllSubscribers("SIGNED_IN",c);case 7:case"end":return t.stop()}}),t)}))),0),t.abrupt("return",{error:null});case 32:return t.next=34,this._recoverAndRefresh();case 34:return t.abrupt("return",{error:null});case 37:if(t.prev=37,t.t0=t.catch(0),!zr(t.t0)){t.next=41;break}return t.abrupt("return",{error:t.t0});case 41:return t.abrupt("return",{error:new Hr("Unexpected error during initialization",t.t0)});case 42:return t.prev=42,t.next=45,this._handleVisibilityChange();case 45:return this._debug("#_initialize()","end"),t.finish(42);case 47:case"end":return t.stop()}}),t,this,[[0,37,42,47]])}))),function(){return ot.apply(this,arguments)})},{key:"signInAnonymously",value:(nt=so(io().mark((function t(e){var r,n,o,i,a,u,c,s;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dn(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(n=null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(o=null==e?void 0:e.options)||void 0===o?void 0:o.captchaToken}},xform:mn});case 3:if(i=t.sent,a=i.data,!(u=i.error)&&a){t.next=7;break}return t.abrupt("return",{data:{user:null,session:null},error:u});case 7:if(c=a.session,s=a.user,!a.session){t.next=14;break}return t.next=12,this._saveSession(a.session);case 12:return t.next=14,this._notifyAllSubscribers("SIGNED_IN",c);case 14:return t.abrupt("return",{data:{user:s,session:c},error:null});case 17:if(t.prev=17,t.t0=t.catch(0),!zr(t.t0)){t.next=21;break}return t.abrupt("return",{data:{user:null,session:null},error:t.t0});case 21:throw t.t0;case 22:case"end":return t.stop()}}),t,this,[[0,17]])}))),function(t){return nt.apply(this,arguments)})},{key:"signUp",value:(rt=so(io().mark((function t(e){var r,n,o,i,a,u,c,s,l,f,h,p,d,v,y,b,m,g,w;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!("email"in e)){t.next=18;break}if(a=e.email,u=e.password,c=e.options,s=null,l=null,"pkce"!==this.flowType){t.next=13;break}return t.next=9,Lr(this.storage,this.storageKey);case 9:f=t.sent,h=ro(f,2),s=h[0],l=h[1];case 13:return t.next=15,dn(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null==c?void 0:c.emailRedirectTo,body:{email:a,password:u,data:null!==(r=null==c?void 0:c.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken},code_challenge:s,code_challenge_method:l},xform:mn});case 15:i=t.sent,t.next=26;break;case 18:if(!("phone"in e)){t.next=25;break}return p=e.phone,d=e.password,v=e.options,t.next=22,dn(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:p,password:d,data:null!==(n=null==v?void 0:v.data)&&void 0!==n?n:{},channel:null!==(o=null==v?void 0:v.channel)&&void 0!==o?o:"sms",gotrue_meta_security:{captcha_token:null==v?void 0:v.captchaToken}},xform:mn});case 22:i=t.sent,t.next=26;break;case 25:throw new Xr("You must provide either an email or phone number and a password");case 26:if(b=(y=i).data,!(m=y.error)&&b){t.next=29;break}return t.abrupt("return",{data:{user:null,session:null},error:m});case 29:if(g=b.session,w=b.user,!b.session){t.next=36;break}return t.next=34,this._saveSession(b.session);case 34:return t.next=36,this._notifyAllSubscribers("SIGNED_IN",g);case 36:return t.abrupt("return",{data:{user:w,session:g},error:null});case 39:if(t.prev=39,t.t0=t.catch(0),!zr(t.t0)){t.next=43;break}return t.abrupt("return",{data:{user:null,session:null},error:t.t0});case 43:throw t.t0;case 44:case"end":return t.stop()}}),t,this,[[0,39]])}))),function(t){return rt.apply(this,arguments)})},{key:"signInWithPassword",value:(et=so(io().mark((function t(e){var r,n,o,i,a,u,c,s,l,f;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!("email"in e)){t.next=8;break}return n=e.email,o=e.password,i=e.options,t.next=5,dn(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:n,password:o,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:gn});case 5:case 12:r=t.sent,t.next=16;break;case 8:if(!("phone"in e)){t.next=15;break}return a=e.phone,u=e.password,c=e.options,t.next=12,dn(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:a,password:u,gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken}},xform:gn});case 15:throw new Xr("You must provide either an email or phone number and a password");case 16:if(l=(s=r).data,!(f=s.error)){t.next=21;break}return t.abrupt("return",{data:{user:null,session:null},error:f});case 21:if(l&&l.session&&l.user){t.next=23;break}return t.abrupt("return",{data:{user:null,session:null},error:new $r});case 23:if(!l.session){t.next=28;break}return t.next=26,this._saveSession(l.session);case 26:return t.next=28,this._notifyAllSubscribers("SIGNED_IN",l.session);case 28:return t.abrupt("return",{data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:f});case 31:if(t.prev=31,t.t0=t.catch(0),!zr(t.t0)){t.next=35;break}return t.abrupt("return",{data:{user:null,session:null},error:t.t0});case 35:throw t.t0;case 36:case"end":return t.stop()}}),t,this,[[0,31]])}))),function(t){return et.apply(this,arguments)})},{key:"signInWithOAuth",value:(tt=so(io().mark((function t(e){var r,n,o,i;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._handleProviderSignIn(e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(o=e.options)||void 0===o?void 0:o.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return tt.apply(this,arguments)})},{key:"exchangeCodeForSession",value:(Z=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initializePromise;case 2:return t.abrupt("return",this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r._exchangeCodeForSession(e));case 1:case"end":return t.stop()}}),t)})))));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return Z.apply(this,arguments)})},{key:"_exchangeCodeForSession",value:(Q=so(io().mark((function t(e){var r,n,o,i,a,u,c,s;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vr(this.storage,"".concat(this.storageKey,"-code-verifier"));case 2:return r=t.sent,n=(null!=r?r:"").split("/"),o=ro(n,2),i=o[0],a=o[1],t.prev=4,t.next=7,dn(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:mn});case 7:return u=t.sent,c=u.data,s=u.error,t.next=12,yr(this.storage,"".concat(this.storageKey,"-code-verifier"));case 12:if(!s){t.next=14;break}throw s;case 14:if(c&&c.session&&c.user){t.next=16;break}return t.abrupt("return",{data:{user:null,session:null,redirectType:null},error:new $r});case 16:if(!c.session){t.next=21;break}return t.next=19,this._saveSession(c.session);case 19:return t.next=21,this._notifyAllSubscribers("SIGNED_IN",c.session);case 21:return t.abrupt("return",{data:Object.assign(Object.assign({},c),{redirectType:null!=a?a:null}),error:s});case 24:if(t.prev=24,t.t0=t.catch(4),!zr(t.t0)){t.next=28;break}return t.abrupt("return",{data:{user:null,session:null,redirectType:null},error:t.t0});case 28:throw t.t0;case 29:case"end":return t.stop()}}),t,this,[[4,24]])}))),function(t){return Q.apply(this,arguments)})},{key:"signInWithIdToken",value:(X=so(io().mark((function t(e){var r,n,o,i,a,u,c,s;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.options,n=e.provider,o=e.token,i=e.access_token,a=e.nonce,t.next=4,dn(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:n,id_token:o,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken}},xform:mn});case 4:if(u=t.sent,c=u.data,!(s=u.error)){t.next=10;break}return t.abrupt("return",{data:{user:null,session:null},error:s});case 10:if(c&&c.session&&c.user){t.next=12;break}return t.abrupt("return",{data:{user:null,session:null},error:new $r});case 12:if(!c.session){t.next=17;break}return t.next=15,this._saveSession(c.session);case 15:return t.next=17,this._notifyAllSubscribers("SIGNED_IN",c.session);case 17:return t.abrupt("return",{data:c,error:s});case 20:if(t.prev=20,t.t0=t.catch(0),!zr(t.t0)){t.next=24;break}return t.abrupt("return",{data:{user:null,session:null},error:t.t0});case 24:throw t.t0;case 25:case"end":return t.stop()}}),t,this,[[0,20]])}))),function(t){return X.apply(this,arguments)})},{key:"signInWithOtp",value:($=so(io().mark((function t(e){var r,n,o,i,a,u,c,s,l,f,h,p,d,v,y,b,m,g;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!("email"in e)){t.next=18;break}if(u=e.email,c=e.options,s=null,l=null,"pkce"!==this.flowType){t.next=13;break}return t.next=9,Lr(this.storage,this.storageKey);case 9:f=t.sent,h=ro(f,2),s=h[0],l=h[1];case 13:return t.next=15,dn(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:u,data:null!==(r=null==c?void 0:c.data)&&void 0!==r?r:{},create_user:null===(n=null==c?void 0:c.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken},code_challenge:s,code_challenge_method:l},redirectTo:null==c?void 0:c.emailRedirectTo});case 15:return p=t.sent,d=p.error,t.abrupt("return",{data:{user:null,session:null},error:d});case 18:if(!("phone"in e)){t.next=26;break}return v=e.phone,y=e.options,t.next=22,dn(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:v,data:null!==(o=null==y?void 0:y.data)&&void 0!==o?o:{},create_user:null===(i=null==y?void 0:y.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==y?void 0:y.captchaToken},channel:null!==(a=null==y?void 0:y.channel)&&void 0!==a?a:"sms"}});case 22:return b=t.sent,m=b.data,g=b.error,t.abrupt("return",{data:{user:null,session:null,messageId:null==m?void 0:m.message_id},error:g});case 26:throw new Xr("You must provide either an email or phone number.");case 29:if(t.prev=29,t.t0=t.catch(0),!zr(t.t0)){t.next=33;break}return t.abrupt("return",{data:{user:null,session:null},error:t.t0});case 33:throw t.t0;case 34:case"end":return t.stop()}}),t,this,[[0,29]])}))),function(t){return $.apply(this,arguments)})},{key:"verifyOtp",value:(W=so(io().mark((function t(e){var r,n,o,i,a,u,c,s,l;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=void 0,i=void 0,"options"in e&&(o=null===(r=e.options)||void 0===r?void 0:r.redirectTo,i=null===(n=e.options)||void 0===n?void 0:n.captchaToken),t.next=6,dn(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:o,xform:mn});case 6:if(a=t.sent,u=a.data,!(c=a.error)){t.next=11;break}throw c;case 11:if(u){t.next=13;break}throw new Error("An error occurred on token verification.");case 13:if(s=u.session,l=u.user,!(null==s?void 0:s.access_token)){t.next=20;break}return t.next=18,this._saveSession(s);case 18:return t.next=20,this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",s);case 20:return t.abrupt("return",{data:{user:l,session:s},error:null});case 23:if(t.prev=23,t.t0=t.catch(0),!zr(t.t0)){t.next=27;break}return t.abrupt("return",{data:{user:null,session:null},error:t.t0});case 27:throw t.t0;case 28:case"end":return t.stop()}}),t,this,[[0,23]])}))),function(t){return W.apply(this,arguments)})},{key:"signInWithSSO",value:(Y=so(io().mark((function t(e){var r,n,o,i,a,u,c;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=null,a=null,"pkce"!==this.flowType){t.next=11;break}return t.next=7,Lr(this.storage,this.storageKey);case 7:u=t.sent,c=ro(u,2),i=c[0],a=c[1];case 11:return t.next=13,dn(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(r=e.options)||void 0===r?void 0:r.redirectTo)&&void 0!==n?n:void 0}),(null===(o=null==e?void 0:e.options)||void 0===o?void 0:o.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:kn});case 13:return t.abrupt("return",t.sent);case 16:if(t.prev=16,t.t0=t.catch(0),!zr(t.t0)){t.next=20;break}return t.abrupt("return",{data:null,error:t.t0});case 20:throw t.t0;case 21:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(t){return Y.apply(this,arguments)})},{key:"reauthenticate",value:(H=so(io().mark((function t(){var e=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initializePromise;case 2:return t.next=4,this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._reauthenticate();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(){return H.apply(this,arguments)})},{key:"_reauthenticate",value:(V=so(io().mark((function t(){var e=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._useSession(function(){var t=so(io().mark((function t(r){var n,o,i,a;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.data.session,!(o=r.error)){t.next=3;break}throw o;case 3:if(n){t.next=5;break}throw new Wr;case 5:return t.next=7,dn(e.fetch,"GET","".concat(e.url,"/reauthenticate"),{headers:e.headers,jwt:n.access_token});case 7:return i=t.sent,a=i.error,t.abrupt("return",{data:{user:null,session:null},error:a});case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),!zr(t.t0)){t.next=10;break}return t.abrupt("return",{data:{user:null,session:null},error:t.t0});case 10:throw t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return V.apply(this,arguments)})},{key:"resend",value:(K=so(io().mark((function t(e){var r,n,o,i,a,u,c,s,l,f,h,p;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r="".concat(this.url,"/resend"),!("email"in e)){t.next=11;break}return n=e.email,o=e.type,i=e.options,t.next=6,dn(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:o,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});case 6:return a=t.sent,u=a.error,t.abrupt("return",{data:{user:null,session:null},error:u});case 11:if(!("phone"in e)){t.next=19;break}return c=e.phone,s=e.type,l=e.options,t.next=15,dn(this.fetch,"POST",r,{headers:this.headers,body:{phone:c,type:s,gotrue_meta_security:{captcha_token:null==l?void 0:l.captchaToken}}});case 15:return f=t.sent,h=f.data,p=f.error,t.abrupt("return",{data:{user:null,session:null,messageId:null==h?void 0:h.message_id},error:p});case 19:throw new Xr("You must provide either an email or phone number and a type");case 22:if(t.prev=22,t.t0=t.catch(0),!zr(t.t0)){t.next=26;break}return t.abrupt("return",{data:{user:null,session:null},error:t.t0});case 26:throw t.t0;case 27:case"end":return t.stop()}}),t,this,[[0,22]])}))),function(t){return K.apply(this,arguments)})},{key:"getSession",value:(z=so(io().mark((function t(){var e,r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initializePromise;case 2:return t.next=4,this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r._useSession(function(){var t=so(io().mark((function t(e){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)}))));case 4:return e=t.sent,t.abrupt("return",e);case 6:case"end":return t.stop()}}),t,this)}))),function(){return z.apply(this,arguments)})},{key:"_acquireLock",value:(J=so(io().mark((function t(e,r){var n,o,i=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._debug("#_acquireLock","begin",e),t.prev=1,!this.lockAcquired){t.next=7;break}return n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n;case 2:return t.next=4,r();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))(),this.pendingInLock.push(so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o;case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:case"end":return t.stop()}}),t,null,[[0,5]])})))()),t.abrupt("return",o);case 7:return t.next=9,this.lock("lock:".concat(this.storageKey),e,so(io().mark((function t(){var e,n;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i._debug("#_acquireLock","lock acquired for storage key",i.storageKey),t.prev=1,i.lockAcquired=!0,e=r(),i.pendingInLock.push(so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e;case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:case"end":return t.stop()}}),t,null,[[0,5]])})))()),t.next=7,e;case 7:if(!i.pendingInLock.length){t.next=14;break}return n=eo(i.pendingInLock),t.next=11,Promise.all(n);case 11:i.pendingInLock.splice(0,n.length),t.next=7;break;case 14:return t.next=16,e;case 16:return t.abrupt("return",t.sent);case 17:return t.prev=17,i._debug("#_acquireLock","lock released for storage key",i.storageKey),i.lockAcquired=!1,t.finish(17);case 21:case"end":return t.stop()}}),t,null,[[1,,17,21]])}))));case 9:return t.abrupt("return",t.sent);case 10:return t.prev=10,this._debug("#_acquireLock","end"),t.finish(10);case 13:case"end":return t.stop()}}),t,this,[[1,,10,13]])}))),function(t,e){return J.apply(this,arguments)})},{key:"_useSession",value:(q=so(io().mark((function t(e){var r;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._debug("#_useSession","begin"),t.prev=1,t.next=4,this.__loadSession();case 4:return r=t.sent,t.next=7,e(r);case 7:return t.abrupt("return",t.sent);case 8:return t.prev=8,this._debug("#_useSession","end"),t.finish(8);case 11:case"end":return t.stop()}}),t,this,[[1,,8,11]])}))),function(t){return q.apply(this,arguments)})},{key:"__loadSession",value:(M=so(io().mark((function t(){var e,r,n,o,i,a,u,c,s=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack),t.prev=2,e=null,t.next=6,vr(this.storage,this.storageKey);case 6:if(r=t.sent,this._debug("#getSession()","session from storage",r),null===r){t.next=16;break}if(!this._isValidSession(r)){t.next=13;break}e=r,t.next=16;break;case 13:return this._debug("#getSession()","session from storage is not valid"),t.next=16,this._removeSession();case 16:if(e){t.next=18;break}return t.abrupt("return",{data:{session:null},error:null});case 18:if(n=!!e.expires_at&&e.expires_at<=Date.now()/1e3,this._debug("#__loadSession()","session has".concat(n?"":" not"," expired"),"expires_at",e.expires_at),n){t.next=23;break}return this.storage.isServer&&(o=this.suppressGetSessionWarning,i=new Proxy(e,{get:function(t,e,r){return o||"user"!==e||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,s.suppressGetSessionWarning=!0),Reflect.get(t,e,r)}}),e=i),t.abrupt("return",{data:{session:e},error:null});case 23:return t.next=25,this._callRefreshToken(e.refresh_token);case 25:if(a=t.sent,u=a.session,!(c=a.error)){t.next=30;break}return t.abrupt("return",{data:{session:null},error:c});case 30:return t.abrupt("return",{data:{session:u},error:null});case 31:return t.prev=31,this._debug("#__loadSession()","end"),t.finish(31);case 34:case"end":return t.stop()}}),t,this,[[2,,31,34]])}))),function(){return M.apply(this,arguments)})},{key:"getUser",value:(B=so(io().mark((function t(e){var r,n=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}return t.next=3,this._getUser(e);case 3:return t.abrupt("return",t.sent);case 4:return t.next=6,this.initializePromise;case 6:return t.next=8,this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._getUser();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))));case 8:return r=t.sent,t.abrupt("return",r);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return B.apply(this,arguments)})},{key:"_getUser",value:(D=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e){t.next=5;break}return t.next=4,dn(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:wn});case 4:case 7:return t.abrupt("return",t.sent);case 5:return t.next=7,this._useSession(function(){var t=so(io().mark((function t(e){var n,o,i,a,u;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.data,!(u=e.error)){t.next=3;break}throw u;case 3:if((null===(n=a.session)||void 0===n?void 0:n.access_token)||r.hasCustomAuthorizationHeader){t.next=5;break}return t.abrupt("return",{data:{user:null},error:new Wr});case 5:return t.next=7,dn(r.fetch,"GET","".concat(r.url,"/user"),{headers:r.headers,jwt:null!==(i=null===(o=a.session)||void 0===o?void 0:o.access_token)&&void 0!==i?i:void 0,xform:wn});case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:if(t.prev=10,t.t0=t.catch(0),!zr(t.t0)){t.next=19;break}if(!zr(n=t.t0)||"AuthSessionMissingError"!==n.name){t.next=18;break}return t.next=16,this._removeSession();case 16:return t.next=18,yr(this.storage,"".concat(this.storageKey,"-code-verifier"));case 18:return t.abrupt("return",{data:{user:null},error:t.t0});case 19:throw t.t0;case 20:case"end":return t.stop()}var n}),t,this,[[0,10]])}))),function(t){return D.apply(this,arguments)})},{key:"updateUser",value:(U=so(io().mark((function t(e){var r,n=this,o=arguments;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,this.initializePromise;case 3:return t.next=5,this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateUser(e,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return U.apply(this,arguments)})},{key:"_updateUser",value:(F=so(io().mark((function t(e){var r,n=this,o=arguments;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},t.prev=1,t.next=4,this._useSession(function(){var t=so(io().mark((function t(o){var i,a,u,c,s,l,f,h,p,d;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=o.data,!(a=o.error)){t.next=3;break}throw a;case 3:if(i.session){t.next=5;break}throw new Wr;case 5:if(u=i.session,c=null,s=null,"pkce"!==n.flowType||null==e.email){t.next=16;break}return t.next=12,Lr(n.storage,n.storageKey);case 12:l=t.sent,f=ro(l,2),c=f[0],s=f[1];case 16:return t.next=18,dn(n.fetch,"PUT","".concat(n.url,"/user"),{headers:n.headers,redirectTo:null==r?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:s}),jwt:u.access_token,xform:wn});case 18:if(h=t.sent,p=h.data,!(d=h.error)){t.next=23;break}throw d;case 23:return u.user=p.user,t.next=26,n._saveSession(u);case 26:return t.next=28,n._notifyAllSubscribers("USER_UPDATED",u);case 28:return t.abrupt("return",{data:{user:u.user},error:null});case 29:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:return t.abrupt("return",t.sent);case 7:if(t.prev=7,t.t0=t.catch(1),!zr(t.t0)){t.next=11;break}return t.abrupt("return",{data:{user:null},error:t.t0});case 11:throw t.t0;case 12:case"end":return t.stop()}}),t,this,[[1,7]])}))),function(t){return F.apply(this,arguments)})},{key:"_decodeJWT",value:function(t){return mr(t)}},{key:"setSession",value:(G=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initializePromise;case 2:return t.next=4,this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r._setSession(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return G.apply(this,arguments)})},{key:"_setSession",value:(N=so(io().mark((function t(e){var r,n,o,i,a,u,c,s,l,f,h;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.access_token&&e.refresh_token){t.next=3;break}throw new Wr;case 3:if(r=Date.now()/1e3,n=r,o=!0,i=null,(a=mr(e.access_token)).exp&&(n=a.exp,o=n<=r),!o){t.next=22;break}return t.next=12,this._callRefreshToken(e.refresh_token);case 12:if(u=t.sent,c=u.session,!(s=u.error)){t.next=17;break}return t.abrupt("return",{data:{user:null,session:null},error:s});case 17:if(c){t.next=19;break}return t.abrupt("return",{data:{user:null,session:null},error:null});case 19:i=c,t.next=34;break;case 22:return t.next=24,this._getUser(e.access_token);case 24:if(l=t.sent,f=l.data,!(h=l.error)){t.next=29;break}throw h;case 29:return i={access_token:e.access_token,refresh_token:e.refresh_token,user:f.user,token_type:"bearer",expires_in:n-r,expires_at:n},t.next=32,this._saveSession(i);case 32:return t.next=34,this._notifyAllSubscribers("SIGNED_IN",i);case 34:return t.abrupt("return",{data:{user:i.user,session:i},error:null});case 37:if(t.prev=37,t.t0=t.catch(0),!zr(t.t0)){t.next=41;break}return t.abrupt("return",{data:{session:null,user:null},error:t.t0});case 41:throw t.t0;case 42:case"end":return t.stop()}}),t,this,[[0,37]])}))),function(t){return N.apply(this,arguments)})},{key:"refreshSession",value:(R=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initializePromise;case 2:return t.next=4,this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r._refreshSession(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return R.apply(this,arguments)})},{key:"_refreshSession",value:(I=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._useSession(function(){var t=so(io().mark((function t(n){var o,i,a,u,c,s;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=5;break}if(i=n.data,!(a=n.error)){t.next=4;break}throw a;case 4:e=null!==(o=i.session)&&void 0!==o?o:void 0;case 5:if(null==e?void 0:e.refresh_token){t.next=7;break}throw new Wr;case 7:return t.next=9,r._callRefreshToken(e.refresh_token);case 9:if(u=t.sent,c=u.session,!(s=u.error)){t.next=14;break}return t.abrupt("return",{data:{user:null,session:null},error:s});case 14:if(c){t.next=16;break}return t.abrupt("return",{data:{user:null,session:null},error:null});case 16:return t.abrupt("return",{data:{user:c.user,session:c},error:null});case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),!zr(t.t0)){t.next=10;break}return t.abrupt("return",{data:{user:null,session:null},error:t.t0});case 10:throw t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return I.apply(this,arguments)})},{key:"_getSessionFromURL",value:(C=so(io().mark((function t(e,r){var n,o,i,a,u,c,s,l,f,h,p,d,v,y,b,m,g,w,k,_;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,sr()){t.next=3;break}throw new Qr("No browser detected.");case 3:if(!(e.error||e.error_description||e.error_code)){t.next=5;break}throw new Qr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});case 5:t.t0=r,t.next="implicit"===t.t0?8:"pkce"===t.t0?11:14;break;case 8:if("pkce"!==this.flowType){t.next=10;break}throw new tn("Not a valid PKCE flow url.");case 10:case 13:return t.abrupt("break",14);case 11:if("implicit"!==this.flowType){t.next=13;break}throw new Qr("Not a valid implicit grant flow url.");case 14:if("pkce"!==r){t.next=29;break}if(this._debug("#_initialize()","begin","is PKCE flow",!0),e.code){t.next=18;break}throw new tn("No code detected.");case 18:return t.next=20,this._exchangeCodeForSession(e.code);case 20:if(n=t.sent,o=n.data,!(i=n.error)){t.next=25;break}throw i;case 25:return(a=new URL(window.location.href)).searchParams.delete("code"),window.history.replaceState(window.history.state,"",a.toString()),t.abrupt("return",{data:{session:o.session,redirectType:null},error:null});case 29:if(u=e.provider_token,c=e.provider_refresh_token,s=e.access_token,l=e.refresh_token,f=e.expires_in,h=e.expires_at,p=e.token_type,s&&f&&l&&p){t.next=32;break}throw new Qr("No session defined in URL");case 32:return d=Math.round(Date.now()/1e3),v=parseInt(f),y=d+v,h&&(y=parseInt(h)),1e3*(b=y-d)<=fo&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(b,"s, should have been closer to ").concat(v,"s")),d-(m=y-v)>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,y,d):d-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,y,d),t.next=42,this._getUser(s);case 42:if(g=t.sent,w=g.data,!(k=g.error)){t.next=47;break}throw k;case 47:return _={provider_token:u,provider_refresh_token:c,access_token:s,expires_in:v,expires_at:y,refresh_token:l,token_type:p,user:w.user},window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),t.abrupt("return",{data:{session:_,redirectType:e.type},error:null});case 53:if(t.prev=53,t.t1=t.catch(0),!zr(t.t1)){t.next=57;break}return t.abrupt("return",{data:{session:null,redirectType:null},error:t.t1});case 57:throw t.t1;case 58:case"end":return t.stop()}}),t,this,[[0,53]])}))),function(t,e){return C.apply(this,arguments)})},{key:"_isImplicitGrantCallback",value:function(t){return Boolean(t.access_token||t.error_description)}},{key:"_isPKCECallback",value:(A=so(io().mark((function t(e){var r;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vr(this.storage,"".concat(this.storageKey,"-code-verifier"));case 2:return r=t.sent,t.abrupt("return",!(!e.code||!r));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return A.apply(this,arguments)})},{key:"signOut",value:(T=so(io().mark((function t(){var e,r=this,n=arguments;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{scope:"global"},t.next=3,this.initializePromise;case 3:return t.next=5,this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r._signOut(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)}))),function(){return T.apply(this,arguments)})},{key:"_signOut",value:(P=so(io().mark((function t(){var e,r=this,n=arguments;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(n.length>0&&void 0!==n[0]?n[0]:{scope:"global"}).scope,t.next=3,this._useSession(function(){var t=so(io().mark((function t(n){var o,i,a,u,c,s;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.data,!(a=n.error)){t.next=3;break}return t.abrupt("return",{error:a});case 3:if(!(u=null===(o=i.session)||void 0===o?void 0:o.access_token)){t.next=12;break}return t.next=7,r.admin.signOut(u,e);case 7:if(c=t.sent,!(s=c.error)){t.next=12;break}if(Vr(s)&&(404===s.status||401===s.status||403===s.status)){t.next=12;break}return t.abrupt("return",{error:s});case 12:if("others"===e){t.next=17;break}return t.next=15,r._removeSession();case 15:return t.next=17,yr(r.storage,"".concat(r.storageKey,"-code-verifier"));case 17:return t.abrupt("return",{error:null});case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(){return P.apply(this,arguments)})},{key:"onAuthStateChange",value:function(t){var e=this,r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})),n={id:r,callback:t,unsubscribe:function(){e._debug("#unsubscribe()","state change callback with id removed",r),e.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initializePromise;case 2:return t.next=4,e._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e._emitInitialSession(r);case 1:case"end":return t.stop()}}),t)}))));case 4:case"end":return t.stop()}}),t)})))(),{data:{subscription:n}}}},{key:"_emitInitialSession",value:(L=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._useSession(function(){var t=so(io().mark((function t(n){var o,i,a,u;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=n.data.session,!(u=n.error)){t.next=4;break}throw u;case 4:return t.next=6,null===(o=r.stateChangeEmitters.get(e))||void 0===o?void 0:o.callback("INITIAL_SESSION",a);case 6:r._debug("INITIAL_SESSION","callback id",e,"session",a),t.next=15;break;case 9:return t.prev=9,t.t0=t.catch(0),t.next=13,null===(i=r.stateChangeEmitters.get(e))||void 0===i?void 0:i.callback("INITIAL_SESSION",null);case 13:r._debug("INITIAL_SESSION","callback id",e,"error",t.t0),console.error(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}());case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return L.apply(this,arguments)})},{key:"resetPasswordForEmail",value:(O=so(io().mark((function t(e){var r,n,o,i,a,u=arguments;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:{},n=null,o=null,"pkce"!==this.flowType){t.next=11;break}return t.next=7,Lr(this.storage,this.storageKey,!0);case 7:i=t.sent,a=ro(i,2),n=a[0],o=a[1];case 11:return t.prev=11,t.next=14,dn(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo});case 14:return t.abrupt("return",t.sent);case 17:if(t.prev=17,t.t0=t.catch(11),!zr(t.t0)){t.next=21;break}return t.abrupt("return",{data:null,error:t.t0});case 21:throw t.t0;case 22:case"end":return t.stop()}}),t,this,[[11,17]])}))),function(t){return O.apply(this,arguments)})},{key:"getUserIdentities",value:(j=so(io().mark((function t(){var e,r,n,o;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getUser();case 3:if(r=t.sent,n=r.data,!(o=r.error)){t.next=8;break}throw o;case 8:return t.abrupt("return",{data:{identities:null!==(e=n.user.identities)&&void 0!==e?e:[]},error:null});case 11:if(t.prev=11,t.t0=t.catch(0),!zr(t.t0)){t.next=15;break}return t.abrupt("return",{data:null,error:t.t0});case 15:throw t.t0;case 16:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return j.apply(this,arguments)})},{key:"linkIdentity",value:(S=so(io().mark((function t(e){var r,n,o,i,a=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._useSession(function(){var t=so(io().mark((function t(r){var n,o,i,u,c,s,l,f;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=r.data,!(l=r.error)){t.next=3;break}throw l;case 3:return t.next=5,a._getUrlForProvider("".concat(a.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(o=e.options)||void 0===o?void 0:o.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});case 5:return f=t.sent,t.next=8,dn(a.fetch,"GET",f,{headers:a.headers,jwt:null!==(c=null===(u=s.session)||void 0===u?void 0:u.access_token)&&void 0!==c?c:void 0});case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:if(n=t.sent,o=n.data,!(i=n.error)){t.next=8;break}throw i;case 8:return sr()&&!(null===(r=e.options)||void 0===r?void 0:r.skipBrowserRedirect)&&window.location.assign(null==o?void 0:o.url),t.abrupt("return",{data:{provider:e.provider,url:null==o?void 0:o.url},error:null});case 12:if(t.prev=12,t.t0=t.catch(0),!zr(t.t0)){t.next=16;break}return t.abrupt("return",{data:{provider:e.provider,url:null},error:t.t0});case 16:throw t.t0;case 17:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(t){return S.apply(this,arguments)})},{key:"unlinkIdentity",value:(E=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._useSession(function(){var t=so(io().mark((function t(n){var o,i,a,u;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.data,!(u=n.error)){t.next=3;break}throw u;case 3:return t.next=5,dn(r.fetch,"DELETE","".concat(r.url,"/user/identities/").concat(e.identity_id),{headers:r.headers,jwt:null!==(i=null===(o=a.session)||void 0===o?void 0:o.access_token)&&void 0!==i?i:void 0});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),!zr(t.t0)){t.next=10;break}return t.abrupt("return",{data:null,error:t.t0});case 10:throw t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return E.apply(this,arguments)})},{key:"_refreshAccessToken",value:(x=so(io().mark((function t(e){var r,n,o=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="#_refreshAccessToken(".concat(e.substring(0,5),"...)"),this._debug(r,"begin"),t.prev=2,n=Date.now(),t.next=6,kr(function(){var t=so(io().mark((function t(n){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n>0)){t.next=3;break}return t.next=3,gr(200*Math.pow(2,n-1));case 3:return o._debug(r,"refreshing attempt",n),t.next=6,dn(o.fetch,"POST","".concat(o.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:o.headers,xform:mn});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(t,e){var r=200*Math.pow(2,t);return e&&rn(e)&&Date.now()+r-n<fo}));case 6:return t.abrupt("return",t.sent);case 9:if(t.prev=9,t.t0=t.catch(2),this._debug(r,"error",t.t0),!zr(t.t0)){t.next=14;break}return t.abrupt("return",{data:{session:null,user:null},error:t.t0});case 14:throw t.t0;case 15:return t.prev=15,this._debug(r,"end"),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,9,15,18]])}))),function(t){return x.apply(this,arguments)})},{key:"_isValidSession",value:function(t){return"object"===to(t)&&null!==t&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}},{key:"_handleProviderSignIn",value:(_=so(io().mark((function t(e,r){var n;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});case 2:return n=t.sent,this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),sr()&&!r.skipBrowserRedirect&&window.location.assign(n),t.abrupt("return",{data:{provider:e,url:n},error:null});case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return _.apply(this,arguments)})},{key:"_recoverAndRefresh",value:(k=so(io().mark((function t(){var e,r,n,o,i,a,u;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="#_recoverAndRefresh()",this._debug(r,"begin"),t.prev=2,t.next=5,vr(this.storage,this.storageKey);case 5:if(n=t.sent,this._debug(r,"session from storage",n),this._isValidSession(n)){t.next=13;break}if(this._debug(r,"session is not valid"),null===n){t.next=12;break}return t.next=12,this._removeSession();case 12:return t.abrupt("return");case 13:if(o=Math.round(Date.now()/1e3),i=(null!==(e=n.expires_at)&&void 0!==e?e:1/0)<o+10,this._debug(r,"session has".concat(i?"":" not"," expired with margin of ").concat(10,"s")),!i){t.next=30;break}if(!this.autoRefreshToken||!n.refresh_token){t.next=28;break}return t.next=20,this._callRefreshToken(n.refresh_token);case 20:if(a=t.sent,!(u=a.error)){t.next=28;break}if(console.error(u),rn(u)){t.next=28;break}return this._debug(r,"refresh failed with a non-retryable error, removing the session",u),t.next=28,this._removeSession();case 28:t.next=32;break;case 30:return t.next=32,this._notifyAllSubscribers("SIGNED_IN",n);case 32:t.next=39;break;case 34:return t.prev=34,t.t0=t.catch(2),this._debug(r,"error",t.t0),console.error(t.t0),t.abrupt("return");case 39:return t.prev=39,this._debug(r,"end"),t.finish(39);case 42:case"end":return t.stop()}}),t,this,[[2,34,39,42]])}))),function(){return k.apply(this,arguments)})},{key:"_callRefreshToken",value:(w=so(io().mark((function t(e){var r,n,o,i,a,u,c,s;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Wr;case 2:if(!this.refreshingDeferred){t.next=4;break}return t.abrupt("return",this.refreshingDeferred.promise);case 4:return o="#_callRefreshToken(".concat(e.substring(0,5),"...)"),this._debug(o,"begin"),t.prev=6,this.refreshingDeferred=new br,t.next=10,this._refreshAccessToken(e);case 10:if(i=t.sent,a=i.data,!(u=i.error)){t.next=15;break}throw u;case 15:if(a.session){t.next=17;break}throw new Wr;case 17:return t.next=19,this._saveSession(a.session);case 19:return t.next=21,this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);case 21:return c={session:a.session,error:null},this.refreshingDeferred.resolve(c),t.abrupt("return",c);case 26:if(t.prev=26,t.t0=t.catch(6),this._debug(o,"error",t.t0),!zr(t.t0)){t.next=36;break}if(s={session:null,error:t.t0},rn(t.t0)){t.next=34;break}return t.next=34,this._removeSession();case 34:return null===(r=this.refreshingDeferred)||void 0===r||r.resolve(s),t.abrupt("return",s);case 36:throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(t.t0),t.t0;case 38:return t.prev=38,this.refreshingDeferred=null,this._debug(o,"end"),t.finish(38);case 42:case"end":return t.stop()}}),t,this,[[6,26,38,42]])}))),function(t){return w.apply(this,arguments)})},{key:"_notifyAllSubscribers",value:(g=so(io().mark((function t(e,r){var n,o,i,a,u,c=arguments;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!(c.length>2&&void 0!==c[2])||c[2],o="#_notifyAllSubscribers(".concat(e,")"),this._debug(o,"begin",r,"broadcast = ".concat(n)),t.prev=3,this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r}),i=[],a=Array.from(this.stateChangeEmitters.values()).map(function(){var t=so(io().mark((function t(n){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.callback(e,r);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),i.push(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}()),t.next=9,Promise.all(a);case 9:if(!(i.length>0)){t.next=12;break}for(u=0;u<i.length;u+=1)console.error(i[u]);throw i[0];case 12:return t.prev=12,this._debug(o,"end"),t.finish(12);case 15:case"end":return t.stop()}}),t,this,[[3,,12,15]])}))),function(t,e){return g.apply(this,arguments)})},{key:"_saveSession",value:(m=so(io().mark((function t(e){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,t.next=4,dr(this.storage,this.storageKey,e);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"_removeSession",value:(b=so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._debug("#_removeSession()"),t.next=3,yr(this.storage,this.storageKey);case 3:return t.next=5,this._notifyAllSubscribers("SIGNED_OUT",null);case 5:case"end":return t.stop()}}),t,this)}))),function(){return b.apply(this,arguments)})},{key:"_removeVisibilityChangedCallback",value:function(){this._debug("#_removeVisibilityChangedCallback()");var t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&sr()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(t){console.error("removing visibilitychange callback failed",t)}}},{key:"_startAutoRefresh",value:(y=so(io().mark((function t(){var e,r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._stopAutoRefresh();case 2:this._debug("#_startAutoRefresh()"),e=setInterval((function(){return r._autoRefreshTokenTick()}),fo),this.autoRefreshTicker=e,e&&"object"===to(e)&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.initializePromise;case 2:return t.next=4,r._autoRefreshTokenTick();case 4:case"end":return t.stop()}}),t)}))),0);case 7:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{key:"_stopAutoRefresh",value:(v=so(io().mark((function t(){var e;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._debug("#_stopAutoRefresh()"),e=this.autoRefreshTicker,this.autoRefreshTicker=null,e&&clearInterval(e);case 4:case"end":return t.stop()}}),t,this)}))),function(){return v.apply(this,arguments)})},{key:"startAutoRefresh",value:(d=so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._removeVisibilityChangedCallback(),t.next=3,this._startAutoRefresh();case 3:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"stopAutoRefresh",value:(p=so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._removeVisibilityChangedCallback(),t.next=3,this._stopAutoRefresh();case 3:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"_autoRefreshTokenTick",value:(h=so(io().mark((function t(){var e=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._debug("#_autoRefreshTokenTick()","begin"),t.prev=1,t.next=4,this._acquireLock(0,so(io().mark((function t(){var r;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=Date.now(),t.prev=2,t.next=5,e._useSession(function(){var t=so(io().mark((function t(n){var o,i;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((o=n.data.session)&&o.refresh_token&&o.expires_at){t.next=4;break}return e._debug("#_autoRefreshTokenTick()","no session"),t.abrupt("return");case 4:if(i=Math.floor((1e3*o.expires_at-r)/fo),e._debug("#_autoRefreshTokenTick()","access token expires in ".concat(i," ticks, a tick lasts ").concat(fo,"ms, refresh threshold is ").concat(3," ticks")),!(i<=3)){t.next=9;break}return t.next=9,e._callRefreshToken(o.refresh_token);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:return t.abrupt("return",t.sent);case 8:t.prev=8,t.t0=t.catch(2),console.error("Auto refresh tick failed with error. This is likely a transient error.",t.t0);case 11:return t.prev=11,e._debug("#_autoRefreshTokenTick()","end"),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,,11,14],[2,8]])}))));case 4:t.next=13;break;case 6:if(t.prev=6,t.t0=t.catch(1),!(t.t0.isAcquireTimeout||t.t0 instanceof $n)){t.next=12;break}this._debug("auto refresh token tick lock not available"),t.next=13;break;case 12:throw t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,6]])}))),function(){return h.apply(this,arguments)})},{key:"_handleVisibilityChange",value:(f=so(io().mark((function t(){var e=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._debug("#_handleVisibilityChange()"),sr()&&(null===window||void 0===window?void 0:window.addEventListener)){t.next=4;break}return this.autoRefreshToken&&this.startAutoRefresh(),t.abrupt("return",!1);case 4:return t.prev=4,this.visibilityChangedCallback=so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._onVisibilityChanged(!1);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),t.next=9,this._onVisibilityChanged(!0);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),console.error("_handleVisibilityChange",t.t0);case 14:case"end":return t.stop()}}),t,this,[[4,11]])}))),function(){return f.apply(this,arguments)})},{key:"_onVisibilityChanged",value:(l=so(io().mark((function t(e){var r,n=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r="#_onVisibilityChanged(".concat(e,")"),this._debug(r,"visibilityState",document.visibilityState),"visible"!==document.visibilityState){t.next=11;break}if(this.autoRefreshToken&&this._startAutoRefresh(),e){t.next=9;break}return t.next=7,this.initializePromise;case 7:return t.next=9,this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("visible"===document.visibilityState){t.next=3;break}return n._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting"),t.abrupt("return");case 3:return t.next=5,n._recoverAndRefresh();case 5:case"end":return t.stop()}}),t)}))));case 9:t.next=12;break;case 11:"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh();case 12:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"_getUrlForProvider",value:(s=so(io().mark((function t(e,r,n){var o,i,a,u,c,s,l;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=["provider=".concat(encodeURIComponent(r))],(null==n?void 0:n.redirectTo)&&o.push("redirect_to=".concat(encodeURIComponent(n.redirectTo))),(null==n?void 0:n.scopes)&&o.push("scopes=".concat(encodeURIComponent(n.scopes))),"pkce"!==this.flowType){t.next=12;break}return t.next=6,Lr(this.storage,this.storageKey);case 6:i=t.sent,a=ro(i,2),u=a[0],c=a[1],s=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(u)),code_challenge_method:"".concat(encodeURIComponent(c))}),o.push(s.toString());case 12:return(null==n?void 0:n.queryParams)&&(l=new URLSearchParams(n.queryParams),o.push(l.toString())),(null==n?void 0:n.skipBrowserRedirect)&&o.push("skip_http_redirect=".concat(n.skipBrowserRedirect)),t.abrupt("return","".concat(e,"?").concat(o.join("&")));case 15:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return s.apply(this,arguments)})},{key:"_unenroll",value:(c=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._useSession(function(){var t=so(io().mark((function t(n){var o,i,a;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.data,!(a=n.error)){t.next=3;break}return t.abrupt("return",{data:null,error:a});case 3:return t.next=5,dn(r.fetch,"DELETE","".concat(r.url,"/factors/").concat(e.factorId),{headers:r.headers,jwt:null===(o=null==i?void 0:i.session)||void 0===o?void 0:o.access_token});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),!zr(t.t0)){t.next=10;break}return t.abrupt("return",{data:null,error:t.t0});case 10:throw t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return c.apply(this,arguments)})},{key:"_enroll",value:(u=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._useSession(function(){var t=so(io().mark((function t(n){var o,i,a,u,c,s,l,f;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.data,!(u=n.error)){t.next=3;break}return t.abrupt("return",{data:null,error:u});case 3:return c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),t.next=6,dn(r.fetch,"POST","".concat(r.url,"/factors"),{body:c,headers:r.headers,jwt:null===(o=null==a?void 0:a.session)||void 0===o?void 0:o.access_token});case 6:if(s=t.sent,l=s.data,!(f=s.error)){t.next=11;break}return t.abrupt("return",{data:null,error:f});case 11:return"totp"===e.factorType&&(null===(i=null==l?void 0:l.totp)||void 0===i?void 0:i.qr_code)&&(l.totp.qr_code="data:image/svg+xml;utf-8,".concat(l.totp.qr_code)),t.abrupt("return",{data:l,error:null});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),!zr(t.t0)){t.next=10;break}return t.abrupt("return",{data:null,error:t.t0});case 10:throw t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return u.apply(this,arguments)})},{key:"_verify",value:(a=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r._useSession(function(){var t=so(io().mark((function t(n){var o,i,a,u,c,s;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.data,!(a=n.error)){t.next=3;break}return t.abrupt("return",{data:null,error:a});case 3:return t.next=5,dn(r.fetch,"POST","".concat(r.url,"/factors/").concat(e.factorId,"/verify"),{body:{code:e.code,challenge_id:e.challengeId},headers:r.headers,jwt:null===(o=null==i?void 0:i.session)||void 0===o?void 0:o.access_token});case 5:if(u=t.sent,c=u.data,!(s=u.error)){t.next=10;break}return t.abrupt("return",{data:null,error:s});case 10:return t.next=12,r._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c));case 12:return t.next=14,r._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c);case 14:return t.abrupt("return",{data:c,error:s});case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),!zr(t.t0)){t.next=10;break}return t.abrupt("return",{data:null,error:t.t0});case 10:throw t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,6]])})))));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"_challenge",value:(i=so(io().mark((function t(e){var r=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r._useSession(function(){var t=so(io().mark((function t(n){var o,i,a;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.data,!(a=n.error)){t.next=3;break}return t.abrupt("return",{data:null,error:a});case 3:return t.next=5,dn(r.fetch,"POST","".concat(r.url,"/factors/").concat(e.factorId,"/challenge"),{body:{channel:e.channel},headers:r.headers,jwt:null===(o=null==i?void 0:i.session)||void 0===o?void 0:o.access_token});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),!zr(t.t0)){t.next=10;break}return t.abrupt("return",{data:null,error:t.t0});case 10:throw t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,6]])})))));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"_challengeAndVerify",value:(o=so(io().mark((function t(e){var r,n,o;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._challenge({factorId:e.factorId});case 2:if(r=t.sent,n=r.data,!(o=r.error)){t.next=7;break}return t.abrupt("return",{data:null,error:o});case 7:return t.next=9,this._verify({factorId:e.factorId,challengeId:n.id,code:e.code});case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"_listFactors",value:(n=so(io().mark((function t(){var e,r,n,o,i,a;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getUser();case 2:if(e=t.sent,r=e.data.user,!(n=e.error)){t.next=7;break}return t.abrupt("return",{data:null,error:n});case 7:return o=(null==r?void 0:r.factors)||[],i=o.filter((function(t){return"totp"===t.factor_type&&"verified"===t.status})),a=o.filter((function(t){return"phone"===t.factor_type&&"verified"===t.status})),t.abrupt("return",{data:{all:o,totp:i,phone:a},error:null});case 11:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"_getAuthenticatorAssuranceLevel",value:(r=so(io().mark((function t(){var e=this;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._acquireLock(-1,so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._useSession(function(){var t=so(io().mark((function t(r){var n,o,i,a,u,c,s,l;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r.data.session,!(a=r.error)){t.next=3;break}return t.abrupt("return",{data:null,error:a});case 3:if(i){t.next=5;break}return t.abrupt("return",{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null});case 5:return u=e._decodeJWT(i.access_token),c=null,u.aal&&(c=u.aal),s=c,(null!==(o=null===(n=i.user.factors)||void 0===n?void 0:n.filter((function(t){return"verified"===t.status})))&&void 0!==o?o:[]).length>0&&(s="aal2"),l=u.amr||[],t.abrupt("return",{data:{currentLevel:c,nextLevel:s,currentAuthenticationMethods:l},error:null});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))));case 1:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&ao(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,u,c,s,l,f,h,p,d,v,y,b,m,g,w,k,_,x,E,S,j,O,L,P,T,A,C,I,R,N,G,F,U,D,B,M,q,J,z,K,V,H,Y,W,$,X,Q,Z,tt,et,rt,nt,ot,it}();function yo(t){return yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yo(t)}function bo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(bo=function(){return!!t})()}function mo(t){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mo(t)}function go(t,e){return go=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},go(t,e)}vo.nextInstanceID=0;var wo=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=mo(e),function(t,e){if(e&&("object"==yo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,bo()?Reflect.construct(e,r||[],mo(t).constructor):e.apply(t,r))}(this,e,[t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&go(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(vo);function ko(t){return ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ko(t)}function _o(){_o=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==ko(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ko(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function xo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Eo(n.key),n)}}function Eo(t){var e=function(t){if("object"!=ko(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ko(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ko(e)?e:e+""}var So=function(){return t=function t(e,r,n){var o,i,a;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");var u=e.replace(/\/$/,"");this.realtimeUrl="".concat(u,"/realtime/v1").replace(/^http/i,"ws"),this.authUrl="".concat(u,"/auth/v1"),this.storageUrl="".concat(u,"/storage/v1"),this.functionsUrl="".concat(u,"/functions/v1");var c="sb-".concat(new URL(this.authUrl).hostname.split(".")[0],"-auth-token"),s=function(t,e){var r=this,n=t.db,o=t.auth,i=t.realtime,a=t.global,u=e.db,c=e.auth,s=e.realtime,l=e.global,f={db:Object.assign(Object.assign({},u),n),auth:Object.assign(Object.assign({},c),o),realtime:Object.assign(Object.assign({},s),i),global:Object.assign(Object.assign({},l),a),accessToken:function(){return t=r,e=void 0,n=void 0,o=$e().mark((function t(){return $e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","");case 1:case"end":return t.stop()}}),t)})),new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function u(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((o=o.apply(t,e||[])).next())}));var t,e,n,o}};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}(null!=n?n:{},{db:Me,realtime:Je,auth:Object.assign(Object.assign({},qe),{storageKey:c}),global:Be});this.storageKey=null!==(o=s.auth.storageKey)&&void 0!==o?o:"",this.headers=null!==(i=s.global.headers)&&void 0!==i?i:{},s.accessToken?(this.accessToken=s.accessToken,this.auth=new Proxy({},{get:function(t,e){throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(e)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(a=s.auth)&&void 0!==a?a:{},this.headers,s.global.fetch),this.fetch=Ye(r,this._getAccessToken.bind(this),s.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},s.realtime)),this.rest=new P("".concat(u,"/rest/v1"),{headers:this.headers,schema:s.db.schema,fetch:this.fetch}),s.accessToken||this._listenForAuthEvents()},e=[{key:"functions",get:function(){return new O(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}},{key:"storage",get:function(){return new De(this.storageUrl,this.headers,this.fetch)}},{key:"from",value:function(t){return this.rest.from(t)}},{key:"schema",value:function(t){return this.rest.schema(t)}},{key:"rpc",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(t,e,r)}},{key:"channel",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(t,e)}},{key:"getChannels",value:function(){return this.realtime.getChannels()}},{key:"removeChannel",value:function(t){return this.realtime.removeChannel(t)}},{key:"removeAllChannels",value:function(){return this.realtime.removeAllChannels()}},{key:"_getAccessToken",value:function(){var t,e,r,n,o,i;return r=this,n=void 0,o=void 0,i=_o().mark((function r(){var n,o;return _o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!this.accessToken){r.next=4;break}return r.next=3,this.accessToken();case 3:return r.abrupt("return",r.sent);case 4:return r.next=6,this.auth.getSession();case 6:return n=r.sent,o=n.data,r.abrupt("return",null!==(e=null===(t=o.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:null);case 9:case"end":return r.stop()}}),r,this)})),new(o||(o=Promise))((function(t,e){function a(t){try{c(i.next(t))}catch(t){e(t)}}function u(t){try{c(i.throw(t))}catch(t){e(t)}}function c(e){var r;e.done?t(e.value):(r=e.value,r instanceof o?r:new o((function(t){t(r)}))).then(a,u)}c((i=i.apply(r,n||[])).next())}))}},{key:"_initSupabaseAuthClient",value:function(t,e,r){var n,o=t.autoRefreshToken,i=t.persistSession,a=t.detectSessionInUrl,u=t.storage,c=t.storageKey,s=t.flowType,l=t.lock,f=t.debug,h={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new wo({url:this.authUrl,headers:Object.assign(Object.assign({},h),e),storageKey:c,autoRefreshToken:o,persistSession:i,detectSessionInUrl:a,storage:u,flowType:s,lock:l,debug:f,fetch:r,hasCustomAuthorizationHeader:null!==(n="Authorization"in this.headers)&&void 0!==n&&n})}},{key:"_initRealtimeClient",value:function(t){return new Ft(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},null==t?void 0:t.params)}))}},{key:"_listenForAuthEvents",value:function(){var t=this;return this.auth.onAuthStateChange((function(e,r){t._handleTokenChanged(e,"CLIENT",null==r?void 0:r.access_token)}))}},{key:"_handleTokenChanged",value:function(t,e,r){"TOKEN_REFRESHED"!==t&&"SIGNED_IN"!==t||this.changedAccessToken===r?"SIGNED_OUT"===t&&(this.realtime.setAuth(),"STORAGE"==e&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=r}}],e&&xo(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function jo(t){return jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jo(t)}function Oo(){Oo=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==jo(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(jo(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Lo(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Po(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Lo(i,n,o,a,u,"next",t)}function u(t){Lo(i,n,o,a,u,"throw",t)}a(void 0)}))}}function To(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ao(n.key),n)}}function Ao(t){var e=function(t){if("object"!=jo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=jo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==jo(e)?e:e+""}var Co=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._supabase=function(t,e){return new So(t,e,void 0)}(e,r)},e=[{key:"_processResponse",value:(h=Po(Oo().mark((function t(e){return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.error){t.next=2;break}throw new Error(e.error.message);case 2:return t.abrupt("return",e.data);case 3:case"end":return t.stop()}}),t)}))),function(t){return h.apply(this,arguments)})},{key:"_getInitialCards",value:(f=Po(Oo().mark((function t(){var e;return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._supabase.from("cards").select("*").order("created_at",{ascending:!1});case 2:return e=t.sent,t.abrupt("return",this._processResponse(e));case 4:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"_getUserInfo",value:(l=Po(Oo().mark((function t(){var e;return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._supabase.from("users").select("*");case 2:return e=t.sent,t.abrupt("return",this._processResponse(e));case 4:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"renderUserAndCards",value:(s=Po(Oo().mark((function t(){var e;return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([this._getInitialCards(),this._getUserInfo()]);case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"addCard",value:(c=Po(Oo().mark((function t(e,r){var n;return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._supabase.from("cards").insert([{name:e.title,link:e.link,owner_id:r}]).select();case 2:return n=t.sent,t.abrupt("return",this._processResponse(n));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)})},{key:"deleteCard",value:(u=Po(Oo().mark((function t(e){var r;return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._supabase.from("cards").delete().eq("id",e.id);case 2:return r=t.sent,t.abrupt("return",this._processResponse(r));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"setUserInfo",value:(a=Po(Oo().mark((function t(e,r){var n;return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._supabase.from("users").update({name:e.name,bio:e.bio}).eq("id",r).select();case 2:return n=t.sent,t.abrupt("return",this._processResponse(n));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"setUserAvatar",value:(i=Po(Oo().mark((function t(e,r){var n;return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._supabase.from("users").update({avatar:e.avatar}).eq("id",r).select();case 2:return n=t.sent,t.abrupt("return",this._processResponse(n));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"getLikesForCard",value:(o=Po(Oo().mark((function t(e){var r;return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._supabase.from("likes").select("user_id").eq("card_id",e.id);case 2:return r=t.sent,t.abrupt("return",this._processResponse(r));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"setLike",value:(n=Po(Oo().mark((function t(e,r){var n;return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._supabase.from("likes").insert([{card_id:e.id,user_id:r.id}]).select();case 2:return n=t.sent,t.abrupt("return",this._processResponse(n));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"deleteLike",value:(r=Po(Oo().mark((function t(e,r){var n;return Oo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._supabase.from("likes").delete().match({card_id:e.id,user_id:r.id});case 2:return n=t.sent,t.abrupt("return",this._processResponse(n));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})}],e&&To(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,u,c,s,l,f,h}();function Io(t){return Io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Io(t)}function Ro(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,No(n.key),n)}}function No(t){var e=function(t){if("object"!=Io(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Io(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Io(e)?e:e+""}var Go=function(){return t=function t(e,r,n,o,i,a,u,c){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._cardObject=e,this._title=e.name,this._image=e.link,this._likes=r,this._cardId=e.id,this._userId=e.owner_id,this._cardTemplateId=document.querySelector(n),this._cardDelete=o,this._imageZoom=i,this._setLike=a,this._deleteLike=u,this._userId=c,this.isProcessing=!1},(e=[{key:"_getTemplateCard",value:function(){return this._cardTemplateId.content.querySelector(".card").cloneNode(!0)}},{key:"createCard",value:function(){return this._cardElement=this._getTemplateCard(),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._likeCounter=this._cardElement.querySelector(".card__like-counter"),this._deleteButton=this._cardElement.querySelector(".card__delete"),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardData={data:this._cardObject,counter:this._likeCounter},this._likeCounter.textContent=this._likes.length||"",this._cardImage.src=this._image,this._cardImage.alt=this._title,this._cardTitle.textContent=this._title,this._setEventListeners(),this._isLiked(this._likes),this._cardElement}},{key:"_fillLikeButton",value:function(){this._likeButton.classList.add("card__like-button_active")}},{key:"_emptyLikeButton",value:function(){this._likeButton.classList.remove("card__like-button_active")}},{key:"_incrementLikeCounter",value:function(){this._likeCounter.textContent=+this._likeCounter.textContent+1}},{key:"_decrementLikeCounter",value:function(){this._likeCounter.textContent=+this._likeCounter.textContent-1||""}},{key:"_handleUnlike",value:function(t){var e=this;this._decrementLikeCounter(),this._emptyLikeButton(),this._deleteLike(t).catch((function(){e._fillLikeButton(),e._incrementLikeCounter()})).finally((function(){return e.isProcessing=!1}))}},{key:"_handleLike",value:function(t){var e=this;this._incrementLikeCounter(),this._fillLikeButton(),this._setLike(t).catch((function(){e._emptyLikeButton(),e._decrementLikeCounter()})).finally((function(){return e.isProcessing=!1}))}},{key:"_switchLikeState",value:function(t){this.isProcessing||(this.isProcessing=!0,this._likeButton.classList.contains("card__like-button_active")?this._handleUnlike(t):this._handleLike(t))}},{key:"_setEventListeners",value:function(){var t=this;this._cardElement.addEventListener("click",(function(e){var r=e.target;if(r===t._likeButton)t._switchLikeState(t._cardData);else if(r===t._deleteButton)t._cardDelete({data:t._cardObject,element:t._cardElement});else{var n={image:t._cardObject.link,title:t._cardObject.name};t._imageZoom(n)}}))}},{key:"_isLiked",value:function(t){var e=this;t.forEach((function(t){t.user_id===e._userId&&e._fillLikeButton()}))}}])&&Ro(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Fo(t){return Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fo(t)}function Uo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bo(n.key),n)}}function Do(t,e,r){return(e=Bo(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bo(t){var e=function(t){if("object"!=Fo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Fo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Fo(e)?e:e+""}var Mo=function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Do(this,"_showInputError",(function(t){var e=n._form.querySelector("#".concat(t.id,"-error"));e.textContent=t.validationMessage,e.classList.add(n._config.formErrorVisibleSelector)})),Do(this,"_hideInputError",(function(t){var e=n._form.querySelector("#".concat(t.id,"-error"));t.classList.remove(n._config.inputErrorSelector),e.textContent="",e.classList.remove(n._config.formErrorVisibleSelector)})),Do(this,"_checkInputValidity",(function(t){t.validity.valid?n._hideInputError(t):n._showInputError(t)})),this._form=r,this._config=e,this._inputList=Array.from(this._form.querySelectorAll(this._config.inputSelector)),this._submitButton=this._form.querySelector(this._config.submitButtonSelector)},(e=[{key:"_switchButtonState",value:function(){var t=this._form.checkValidity();this._submitButton.classList.toggle(this._config.inactiveSubmitButtonSelector,!t),this._submitButton.disabled=!t}},{key:"_setEventListeners",value:function(){var t=this;this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._checkInputValidity(e),t._switchButtonState()}))}))}},{key:"resetValidation",value:function(){var t=this;this._switchButtonState(),this._inputList.forEach((function(e){return t._hideInputError(e)}))}},{key:"enableValidation",value:function(){this._form.addEventListener("submit",(function(t){t.preventDefault()})),this._setEventListeners()}}])&&Uo(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function qo(t){return qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qo(t)}function Jo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zo(n.key),n)}}function zo(t){var e=function(t){if("object"!=qo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=qo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qo(e)?e:e+""}var Ko=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.popup=document.querySelector(e),this._handleClickEsc=this._handleClickEsc.bind(this),this._handleCloseEvent=this._handleCloseEvent.bind(this)},(e=[{key:"open",value:function(){this.popup.classList.add("popup__opened"),document.addEventListener("keydown",this._handleClickEsc),this.popup.addEventListener("mousedown",this._handleCloseEvent)}},{key:"close",value:function(){this.popup.classList.remove("popup__opened"),document.removeEventListener("keydown",this._handleClickEsc),this.popup.removeEventListener("mousedown",this._handleCloseEvent)}},{key:"_handleClickEsc",value:function(t){"Escape"===t.key&&this.close()}},{key:"_handleCloseEvent",value:function(t){(t.target.classList.contains("popup__opened")||t.target.classList.contains("popup__close-button"))&&this.close()}}])&&Jo(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Vo(t){return Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vo(t)}function Ho(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yo(n.key),n)}}function Yo(t){var e=function(t){if("object"!=Vo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Vo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Vo(e)?e:e+""}function Wo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Wo=function(){return!!t})()}function $o(){return $o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Xo(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},$o.apply(null,arguments)}function Xo(t){return Xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xo(t)}function Qo(t,e){return Qo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Qo(t,e)}var Zo=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,r){return e=Xo(e),function(t,e){if(e&&("object"==Vo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Wo()?Reflect.construct(e,r||[],Xo(t).constructor):e.apply(t,r))}(this,e,[t])).popupForm=n.popup.querySelector(".popup__form"),n._callbackSubmit=r,n._inputList=Array.from(n.popupForm.querySelectorAll(".form__input")),n._formValues={},n._submitButton=n.popupForm.querySelector(".form__save-button"),n.setEventListeners(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qo(t,e)}(e,t),r=e,n=[{key:"_getInputValues",value:function(){var t=this;return this._inputList.forEach((function(e){return t._formValues[e.name]=e.value})),this._formValues}},{key:"setEventListeners",value:function(){var t=this;this.popupForm.addEventListener("submit",(function(){t._callbackSubmit(t._getInputValues(),t._submitButton)}))}},{key:"close",value:function(){var t,r,n;this.popupForm.reset(),(t=e,r=this,"function"==typeof(n=$o(Xo(1&3?t.prototype:t),"close",r))?function(t){return n.apply(r,t)}:n)([])}}],n&&Ho(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Ko);function ti(t){return ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ti(t)}function ei(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ri(n.key),n)}}function ri(t){var e=function(t){if("object"!=ti(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ti(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ti(e)?e:e+""}function ni(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ni=function(){return!!t})()}function oi(){return oi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ii(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},oi.apply(null,arguments)}function ii(t){return ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ii(t)}function ai(t,e){return ai=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ai(t,e)}var ui=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,r){return e=ii(e),function(t,e){if(e&&("object"==ti(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ni()?Reflect.construct(e,r||[],ii(t).constructor):e.apply(t,r))}(this,e,[t])).popupForm=n.popup.querySelector(".popup__form"),n._callbackSubmit=r,n._submitButton=n.popupForm.querySelector(".form__save-button"),n.setEventListeners(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ai(t,e)}(e,t),r=e,n=[{key:"open",value:function(t){var r,n,o;(r=e,n=this,"function"==typeof(o=oi(ii(1&3?r.prototype:r),"open",n))?function(t){return o.apply(n,t)}:o)([]),this._data=t}},{key:"setEventListeners",value:function(){var t=this;this.popupForm.addEventListener("submit",(function(){t._callbackSubmit(t._data,t._submitButton)}))}}],n&&ei(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Ko);function ci(t){return ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ci(t)}function si(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,li(n.key),n)}}function li(t){var e=function(t){if("object"!=ci(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ci(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ci(e)?e:e+""}function fi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(fi=function(){return!!t})()}function hi(){return hi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=pi(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},hi.apply(null,arguments)}function pi(t){return pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pi(t)}function di(t,e){return di=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},di(t,e)}var vi=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=pi(e),function(t,e){if(e&&("object"==ci(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fi()?Reflect.construct(e,r||[],pi(t).constructor):e.apply(t,r))}(this,e,[t]))._popupImage=r.popup.querySelector(".popup__image"),r._popupCaption=r.popup.querySelector(".popup__caption"),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&di(t,e)}(e,t),r=e,n=[{key:"open",value:function(t){var r,n,o,i=t.image,a=t.title;this._popupImage.src=i,this._popupImage.alt=a,this._popupCaption.textContent=a,(r=e,n=this,"function"==typeof(o=hi(pi(1&3?r.prototype:r),"open",n))?function(t){return o.apply(n,t)}:o)([])}}],n&&si(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Ko);function yi(t){return yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yi(t)}function bi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mi(n.key),n)}}function mi(t){var e=function(t){if("object"!=yi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=yi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==yi(e)?e:e+""}function gi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(gi=function(){return!!t})()}function wi(t,e,r,n){var o=ki(_i(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function ki(){return ki="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_i(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ki.apply(null,arguments)}function _i(t){return _i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_i(t)}function xi(t,e){return xi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xi(t,e)}var Ei=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=_i(e),function(t,e){if(e&&("object"==yi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,gi()?Reflect.construct(e,r||[],_i(t).constructor):e.apply(t,r))}(this,e,[t]))._loader=r.popup.querySelector(".popup__loader_spinner"),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xi(t,e)}(e,t),r=e,(n=[{key:"open",value:function(){this._loader.classList.add("popup__loader_animation-active"),wi(e,"open",this,3)([])}},{key:"close",value:function(){this._loader.classList.remove("popup__loader_animation-active"),wi(e,"close",this,3)([])}}])&&bi(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Ko);function Si(t){return Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Si(t)}function ji(){ji=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Si(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Si(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Oi(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Li(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pi(n.key),n)}}function Pi(t){var e=function(t){if("object"!=Si(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Si(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Si(e)?e:e+""}var Ti=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._container=document.querySelector(e),this._buildCardsArray=r},e=[{key:"_renderSection",value:function(t){var e=this;t.forEach((function(t){return e.addItem(t,"append")}))}},{key:"addItem",value:function(t,e){"append"==e?this._container.append(t):this._container.prepend(t)}},{key:"processAndRenderCards",value:(r=ji().mark((function t(e){var r,n;return ji().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._buildCardsArray(e);case 2:return r=t.sent,t.next=5,Promise.all(r);case 5:n=t.sent,this._renderSection(n);case 7:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){Oi(i,n,o,a,u,"next",t)}function u(t){Oi(i,n,o,a,u,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})}],e&&Li(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Ai(t){return Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ai(t)}function Ci(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ii(n.key),n)}}function Ii(t){var e=function(t){if("object"!=Ai(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ai(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ai(e)?e:e+""}var Ri=function(){return t=function t(e){var r=e.avatarSelector,n=e.nameSelector,o=e.bioSelector;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._avatar=document.querySelector(r),this._name=document.querySelector(n),this._bio=document.querySelector(o),this.userId},(e=[{key:"_setUserObject",value:function(t){this._userData=t}},{key:"getUserObject",value:function(){return this._userData}},{key:"_setUserId",value:function(t){this.userId=t.id}},{key:"setUserInfo",value:function(t){this._name.textContent=t.name,this._bio.textContent=t.bio}},{key:"getUserInfo",value:function(){return{name:this._name.textContent,bio:this._bio.textContent}}},{key:"setUserAvatar",value:function(t){this._avatar.src=t.avatar}},{key:"renderUserInfo",value:function(t){this._setUserObject(t),this.setUserInfo(t),this.setUserAvatar(t),this._setUserId(t)}}])&&Ci(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),Ni=document.querySelector(".profile__avatar-container"),Gi=document.querySelector(".edit-button"),Fi=document.querySelector(".add-button"),Ui=document.querySelector("#name"),Di=document.querySelector("#bio"),Bi={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__save-button",inputErrorSelector:"form__input_has-error",inactiveSubmitButtonSelector:"form__save-button_disabled",formErrorVisibleSelector:"form__error_opened"};function Mi(t){return Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mi(t)}function qi(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ji(){Ji=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function b(){}function m(){}function g(){}var w={};s(w,a,(function(){return this}));var k=Object.getPrototypeOf,_=k&&k(k(A([])));_&&_!==r&&n.call(_,a)&&(w=_);var x=g.prototype=b.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Mi(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=O(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Mi(e)+" is not iterable")}return m.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function zi(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Ki(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){zi(i,n,o,a,u,"next",t)}function u(t){zi(i,n,o,a,u,"throw",t)}a(void 0)}))}}var Vi=new Co("https://tktlrhkuqyfoarhbytxr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrdGxyaGt1cXlmb2FyaGJ5dHhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM1NTg4NzIsImV4cCI6MjA0OTEzNDg3Mn0.w5LR6BHgDhcLsKOSpJsA2NDips10l_siiCzvC0EMZtw"),Hi=new Ei("#popup-loader");function Yi(){return(Yi=Ki(Ji().mark((function t(){var e,r,n,o;return Ji().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,Hi.open(),t.next=4,Vi.renderUserAndCards();case 4:e=t.sent,a=2,r=function(t){if(Array.isArray(t))return t}(i=e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(i,a)||function(t,e){if(t){if("string"==typeof t)return qi(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qi(t,e):void 0}}(i,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],o=r[1],$i.renderUserInfo(o[0]),Wi.processAndRenderCards(n),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log("Ошибка загрузки данных: ".concat(t.t0));case 15:return t.prev=15,Hi.close(),t.finish(15);case 18:case"end":return t.stop()}var i,a}),t,null,[[0,12,15,18]])})))).apply(this,arguments)}!function(){Yi.apply(this,arguments)}();var Wi=new Ti(".cards__list",(function(t){return t.map(function(){var t=Ki(Ji().mark((function t(e){var r;return Ji().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Vi.getLikesForCard(e);case 2:return r=t.sent,t.abrupt("return",Xi(e,r));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})),$i=new Ri({avatarSelector:".profile__avatar",nameSelector:".profile__name",bioSelector:".profile__bio"});function Xi(t,e){return new Go(t,e,"#card-template",Qi,Zi,ta,ea,$i.userId).createCard()}function Qi(t){ia.open(t)}function Zi(t){aa.open(t)}function ta(t){return Vi.setLike(t.data,$i.getUserObject()).catch((function(t){return console.log(t)}))}function ea(t){return Vi.deleteLike(t.data,$i.getUserObject()).catch((function(t){return console.log(t)}))}var ra=new Zo("#popup-avatar",(function(t,e){e.textContent="Сохранение...",Vi.setUserAvatar(t,$i.userId).then((function(t){$i.setUserAvatar(t[0]),ra.close()})).catch((function(t){return console.log(t)})).finally((function(){return e.textContent="Сохранить"}))})),na=new Zo("#popup-edit",(function(t,e){e.textContent="Сохранение...",Vi.setUserInfo(t,$i.userId).then((function(t){$i.setUserInfo(t[0]),na.close()})).catch((function(t){return console.log(t)})).finally((function(){return e.textContent="Сохранить"}))})),oa=new Zo("#popup-create-card",(function(t,e){e.textContent="Создание...",Vi.addCard(t,$i.userId).then(function(){var t=Ki(Ji().mark((function t(e){var r;return Ji().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Vi.getLikesForCard(e[0]);case 2:r=t.sent,Wi.addItem(Xi(e[0],r)),oa.close();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){return console.log(t)})).finally((function(){return e.textContent="Создать"}))})),ia=new ui("#popup-delete-card",(function(t,e){e.textContent="Удаление...",Vi.deleteCard(t.data).then((function(){t.element.remove(),t.element=null,ia.close()})).catch((function(t){return console.log(t)})).finally((function(){return e.textContent="Да"}))})),aa=new vi("#popup-picture"),ua=[];Array.from(document.forms).forEach((function(t){var e=new Mo(Bi,t);ua[t.name]=e,e.enableValidation()})),Ni.addEventListener("click",(function(){ua[ra.popupForm.name].resetValidation(),ra.open()})),Gi.addEventListener("click",(function(){var t=$i.getUserInfo();Ui.value=t.name,Di.value=t.bio,ua[na.popupForm.name].resetValidation(),na.open()})),Fi.addEventListener("click",(function(){ua[oa.popupForm.name].resetValidation(),oa.open()}))})();
//# sourceMappingURL=main.5151b0340cdacb98a4a1.js.map